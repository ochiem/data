<!DOCTYPE html>
<html>
<head>
    <title>MULTI SCAN :: CEX vs DEX</title>
    <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRQos_LsWFzeI_g7U-lmaA3z1netW2USOsXkQ&usqp=CAU" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        #sinyalkiri{
            font-size: 14px;
            color: rgb(244, 18, 18);
            font-weight: bolder;
        }
        #sinyalkanan{
            font-size: 14px;
            color: rgb(5, 125, 39);
            font-weight: bolder;
        }
        body {
          font-family:sans-serif; 
          font-size: 14px;
          font-weight: bold;
          padding: 8px;
          background-image: linear-gradient(#9389eb,#e7efd8, #95a6ed);
          color: #000;
        }        
        a{
            color:black;
        }
      .container {
            max-width: 1650px;
        }
        a{
            color:black;
        }
        .token{
          background-color: #b574fc;
          color: rgb(255, 254, 254);
          text-align: center;
        }
       .PARA {
        text-align: center;
      background-color: rgb(255 193 193); /* Ganti dengan warna yang Anda inginkan */
       }
       .binance {
        text-align: center;
      background-color: rgb(250 189 36); /* Ganti dengan warna yang Anda inginkan */
       }
       .open {
        text-align: center;
      background-color: #69d5ec; /* Ganti dengan warna yang Anda inginkan */
       }
       .matcha {
        text-align: center;
      background-color: #93ef93; /* Ganti dengan warna yang Anda inginkan */
       }
       .inch {
        text-align: center;
      background-color: #8bef64; /* Ganti dengan warna yang Anda inginkan */
       }
       .KYBER {
        text-align: center;
      background-color: #e9ea1d; /* Ganti dengan warna yang Anda inginkan */
       }

       .ODOS {
        text-align: center;
      background-color: rgb(220, 255, 231); /* Ganti dengan warna yang Anda inginkan */
       }

      #exdate {
          color: #eb0a59;
          font-size: 14px;
      }
      .table {
        font-size: 13px;
      }
      #scanprogress {
        font-size: 16px;
        color: #0b0808;
      }
      #scanbar {
        width:100%;
        height:25px;
        border:1px solid #000;
        padding:2px;
      }
      #bar {
        width:100%;
        background-color:#00ff00;
        height:100%;
      }
      #info {
      font-size: 15px;
      color: #b71616;
      background-color: #bfe389;
      font-weight: bolder;
      margin-top: 35px;
      padding: 2px;
      text-align: center;
      }

      #sinyal {
          width:100%;
          font-size: 15px;
          color: #f1f1f1;
          background-color: #ff4f00;
          margin-top: 15px;
          margin-bottom: 15px;
          padding: 8px;
          text-align: center;
      }
      #status {
        width:100%;
        font-size: 15px;
        color: #e7e8f3;
        background-color: #0e7a2f;
        font-weight: bolder;
        margin-bottom:13px ;
        padding: 8px;
        text-align: center;
      }
      .tableFixHead          { overflow: auto; height: 750px; }
      .tableFixHead thead th { position: sticky; top: 0; z-index: 1; }


    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h3 style="text-align: center; color:#120305;"><img src="https://ambon.go.id/wp-content/uploads/2018/01/new-animated-gif-icon-10.gif" width="25x25"/> MULTI SCAN V.1 :: SETTING DATA 
            <img id="syncDATA" src="https://cdn.icon-icons.com/icons2/2596/PNG/512/database_sync_icon_155524.png" width="30px" /></h3>
            <hr/>
            <form id="form1">

                <div class="form-row">
                    
                    <div class="form-group col-1">
                        <label for="mkiri">MODAL KIRI</label>
                        <input type="checkbox"  id="kiri"  class="myCheckbox2" checked="checked"> <input type="number" class="form-control" id="mkiri" name="input1" value="250" required>
                    </div>
                    <div class="form-group col-1">
                        <label for="mkiri">MODAL KANAN</label>
                        <input type="checkbox"  id="kanan"  class="myCheckbox2" checked="checked" > <input type="number" class="form-control" id="mkanan" name="input1" value="150" required>
                    </div>
                    <div class="form-group col-md-1">
                        <label for="mkiri">SCAN SPEED</label>
                        <select id="delay" name="delay" >
                          <option value="1650" selected>STANDART</option>
                          <option value="1550" >MEDIUM</option>
                          <option value="1400">FAST</option>
                        </select>
                    </div>

                    <div class="form-group col-md-1" >
                      <label for="netpnl">SERVER</label>
                      <select id="serverdex" name="serverdex" >
                      <!--  <option value="SERVER1" selected >SERVER1</option>
                        <option value="SERVER2">SERVER2</option>
                        <option value="SERVER3">SERVER3</option>   
                        <option value="SERVER4">SERVER4</option>
                        <option value="SERVER5">SERVER5</option>
                        <option value="SERVER6">SERVER6</option>
                        <option value="SERVER7">SERVER7</option>   
                        <option value="SERVER8">SERVER8</option>
                        <option value="SERVER9">SERVER9</option>
                        <option value="SERVER10">SERVER10</option>
                      -->
                    </select>                            
                   </div>
                           
                    <div class="form-group col-md-1">
                        <label for="netpnl">BRUTO PNL</label>
                        <input type="checkbox"  id="checkboxFilter" style="display: none;" checked="checked">
                        <input type="number" class="form-control" checked="checked"  id="netpnl" name="input1" value="0.8" required>
                    </div>
                    <div class="form-group col-md-1" >
                        <label for="netpnl">ID TELE</label>
                        <input type="text"   class="form-control"  id="idtele" name="input1"  required>
                    </div>
                  <div class="form-group col-md-1">
                        <div class="form-group">
                            <div><label for="input2">PAIR DEX</label></div>
                            <label for="option1">
                                <input type="radio" id="option1" name="radioOption" checked="checked" value="USDT"> USDT
                            </label>

                            <label for="option5">
                                <input type="radio" id="option4" name="radioOption" value="BNB"> BNB
                            </label>

                        </div> 
                    </div>

                    <div class="form-group col-md-3">
                      <div><label for="input2">MARKET DEX</label></div>                      
                          <input  type="checkbox" id="1INCH" class="myCheckbox"> <label class="form-check-label" for="1inch">1INCH</label>
                          <input type="checkbox" id="OPEN"  class="myCheckbox"> <label class="form-check-label" for="open">OPEN</label>
                          <input type="checkbox" id="PARA"   class="myCheckbox"> <label class="form-check-label" for="PARA">PARA</label> 
                          <input type="checkbox" id="KYBER"   class="myCheckbox"> <label class="form-check-label" for="KYBER">KYBER</label>                           
                          <input type="checkbox" id="ODOS"   class="myCheckbox"> <label class="form-check-label" for="ODOS">ODOS</label>                                                    
                      </div>
                </div>

                <div class="form-row">

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label"> <a href="https://app.1inch.io/" target="_blank">API1</a> </label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKiri"  placeholder=" API 1" value=""  required>
                          </div>
                    </div>

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API2</a></label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKanan"  placeholder=" API 2" value=""  required>
                          </div>
                    </div>

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label"> <a href="https://app.1inch.io/" target="_blank">API3</a> </label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKiri2"  placeholder=" API 3" value=""  required>
                         </div>
                    </div>

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API4</a></label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKanan2"  placeholder=" API 4" value=""  required>
                        </div>
                    </div>

                    <div class="col-md-2">
                      <div class="input-group mb-2">
                          <div class="input-group-prepend">
                              <div class="input-group-text">
                                  <label class="form-check-label"> <a href="https://app.1inch.io/" target="_blank">API5</a> </label>
                              </div>
                          </div>
                          <input type="text" class="form-control" id="api1INCHKiri21"  placeholder=" API 5" value=""  required>
                       </div>
                    </div>

                    <div class="col-md-2">
                      <div class="input-group mb-2">
                          <div class="input-group-prepend">
                              <div class="input-group-text">
                                  <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API6</a></label>
                              </div>
                          </div>
                          <input type="text" class="form-control" id="api1INCHKanan21"  placeholder=" API 6" value=""  required>
                      </div>
                    </div>

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label"> <a href="https://app.1inch.io/" target="_blank">API7</a> </label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKiri22"  placeholder=" API 7" value=""  required>
                          </div>
                    </div>

                    <div class="col-md-2">
                        <div class="input-group mb-2">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API 8</a></label>
                                </div>
                            </div>
                            <input type="text" class="form-control" id="api1INCHKanan22"  placeholder=" API 8" value=""  required>
                        </div>
                    </div>

                    <div class="col-md-2">
                      <div class="input-group mb-2">
                          <div class="input-group-prepend">
                              <div class="input-group-text">
                                  <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API9</a></label>
                              </div>
                          </div>
                          <input type="text" class="form-control" id="api1INCHKiri31"  placeholder=" API 9" value=""  required>
                      </div>
                    </div>

                    <div class="col-md-2">
                      <div class="input-group mb-2">
                          <div class="input-group-prepend">
                              <div class="input-group-text">
                                  <label class="form-check-label" ><a href="https://app.1inch.io/" target="_blank">API10</a></label>
                              </div>
                          </div>
                          <input type="text" class="form-control" id="api1INCHKanan31"  placeholder=" API 10" value=""  required>
                      </div>
                    </div>
          

                  <div class="form-group col-md">
                    <label for="netpnl">
                    <input type="checkbox"  id="autorun">     <label class="form-check-label" for="autorun">AUTORUN</label></label>
                    <button type="button" id="start"    class="btn btn-primary mr-2">START</button><button  type="button" id="refresh2"  class="btn btn-danger">STOP</button>&nbsp;&nbsp;
                 </div>


                </div>

            </form>
        </div>
    </div>
    <div class="row">
        <div class="table-responsive table-sm ">
          <h5 id="hasil" style="margin:15px 0px;text-align: center;background-color: aliceblue;padding: 12px;">:: HASIL SCANNING</h5>            
            <div class="row" style="text-align: center; color: blue;">
              <div class="col-md-4">
                <h6>Sinyal Kiri : </h6>
                  <div id="sinyalkiri"> </div>
              </div>
              <div class="col-md-4">
                <div id="scanprogress">Wait</div> 
                <div id="scanbar">
                    <div id="bar"> </div>
                </div>
                <h2 id="gwei" style="color:rgb(228, 92, 13); font-weight: bolder; font-size:14px; text-align: center;"></h2><hr/>

              </div>
              <div class="col-md-4">
                <h6>Sinyal Kanan : </h6>
                  <div id="sinyalkanan"></div>
              </div>
            </div>  
            <hr/>

            <div class="tableFixHead">
              
            <table id="myTable" class="table table-striped table-hover">
                <thead style="color:#000000; margin: 0.4em; ">
                <tr>
                    <th class="token">NO</th>
                    <th class="binance">BINANCE</th>
                    <th  class="inch" colspan="2" id="1inchkiri" >1INCH <span id="lKiri1INCHSinyal" class="badge badge-success"> </span><span id="lKiri1INCHError" class="badge badge-danger"> </span></th>
                    <th  class="open" colspan="2" id="openkiri" >OPEN <span id="lKiriOPENSinyal" class="badge badge-success"> </span><span id="lKiriOPENError" class="badge badge-danger"> </span></th>
                    <th  class="PARA" colspan="2" id="PARAkiri" >PARA <span id="lKiriPARASinyal" class="badge badge-success"> </span><span id="lKiriPARAError" class="badge badge-danger"> </span></th>
                    <th  class="KYBER" colspan="2" id="KYBERkiri" >KYBER <span id="lKiriKYBERSinyal" class="badge badge-success"> </span><span id="lKiriKYBERError" class="badge badge-danger"> </span></th>
                    <th  class="ODOS" colspan="2" id="ODOSkiri" >ODOS <span id="lKiriODOSSinyal" class="badge badge-success"> </span><span id="lKiriODOSError" class="badge badge-danger"> </span></th>
                   <th class="token"> TOKEN</th>
                    <th  class="inch" colspan="2"  id="1inchkanan" >1INCH <span id="lKanan1INCHSinyal" class="badge badge-success"> </span><span id="lKanan1INCHError" class="badge badge-danger"></span></th>
                    <th  class="open" colspan="2" id="openkanan" >OPEN <span id="lKananOPENSinyal" class="badge badge-success"> </span><span id="lKananOPENError" class="badge badge-danger"></span></th>
                    <th  class="PARA" colspan="2" id="PARAkanan" >PARA <span id="lKananPARASinyal" class="badge badge-success"> </span><span id="lKananPARAError" class="badge badge-danger"></span></th>
                    <th  class="KYBER" colspan="2" id="KYBERkanan" >KYBER <span id="lKananKYBERSinyal" class="badge badge-success"> </span><span id="lKananKYBERError" class="badge badge-danger"> </span></th>
                    <th  class="ODOS" colspan="2" id="ODOSKanan" >ODOS <span id="lKananODOSSinyal" class="badge badge-success"> </span><span id="lKananODOSError" class="badge badge-danger"> </span></th>
                  <th class="binance">BINANCE</th>
                </tr>
                </thead>
                <tbody id="user-table-body">
                <!-- Data akan ditambahkan oleh JavaScript -->
                </tbody>
            </table>
          </div>
          <hr/>
            <h2 style="color:rgb(31, 13, 228); font-size:14px;">
              Keterangan : <br /> </h2>
            <p style="font-size:9px; color: rgb(150, 5, 32);" ;>
            <ol style="color:black;">
              <li>TOKEN - Kode khusus dari admin, silakan hubungi admin dengan menyertakan ID TELEGRAM </li>
              <li>ID TELE - Otomatis terisi setelah memasukan TOKEN, kirim pesan via telegram ke @userinfobot untuk
                mendapatkan
                ID TELEGRAM </li>
              <li>NET PNL - PNL bersih setelah dipotong FEE, filter sinyal yg ingin diterima, gunakan titik penganti koma
              </li>  
                <li>JIKA BANYAK ERROR "KENA LIMIT", SILAKAN COBA GANTI SERVER!! </li>
              <li>Pastikan sudah START dengan BOT TELEGRAM ini : @@multiscan_dex_bot, cari BOT tersebut ditelegram </li>
            </ol>
            </p>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
<script>
    var Kiri1INCHError=0;
    var Kanan1INCHError=0;
    var KiriOPENError=0;
    var KananOPENError=0;
    var KiriPARAError=0;
    var KananPARAError=0;
    var KiriKYBERError=0;
    var KananKYBERError=0;
    var KiriODOSError=0;
    var KananODOSError=0;

    var tickers =[];
    var DATA = {};

    async function getDataJSON(){
      $.ajax({
           url: 'https://ochiem.github.io/data/web_bsc_member.json',
              success : function(response) {
               console.warn(response)
               // alert("jumlah server : "+response.serverCORS.length)
               var serverCORS = response.serverCORS;
               var token = response.token;
               var tele_token = response.telegram.token;
               var id_grup = response.telegram.id_grup;

               var DATA_MASTER={
                TOKEN:tele_token,
                ID_GRUP:id_grup,
                selectServer :"SERVER1",
                SERVERCORS :serverCORS,
                LIST_TOKEN :token,
                SPEED_SCAN : 1650,
                MODALKIRI : 500,
                MODALKANAN : 500,
                PNL : 1,
                ID_TELE: '',
                API1INCH:[
                '',
                '',
                '',
                '',
                '',
                '',
                '',
                '',
                '',
                '',
                ],
                DEX:['1INCH','OPEN','PARA','KYBER','ODOS']
              }

              localStorage.setItem("DATA_MASTER",JSON.stringify(DATA_MASTER))
              localStorage.setItem("DATA_SETTING",JSON.stringify(DATA_MASTER))

              DATA = JSON.parse(localStorage.getItem('DATA_MASTER'));


                // Ambil daftar servercors dari localStorage
                var storedServercorsList = DATA.SERVERCORS;

               // Tampilkan kategori SERVERCORS ke dalam elemen <select> serverdex
                var selectElement = $('#serverdex');
                for (var i = 0; i < storedServercorsList.length; i++) {
                    selectElement.append($('<option>', {
                        value: "SERVER"+(i + 1),
                        text: 'SERVER' + (i + 1)
                    }));
                }
                location.reload()
              },

              error: function(error) {
                  alert('Data Tidak Lengkap');
              }
           });
        }

    $('#syncDATA').on('click', function() {       
         getDataJSON(); 
         alert("SINKRONISASI DATA KESERVER, BERHASIL!!");

         // HAPUS DATA SETINGAN & SIMPAN DATA BARU DARI SERVER JSON KE LOCALSTORAGE SEBAGAI DATA MASTER YAITU:
         /*
            - LIST SERVERCORS
            - LIST TOKEN
         */

    });

    $(document).ready(async function() {
       // await getDataJSON()
       //CEK DATA SETINGAN PADA LOCALSTORAGE, JIKA TIDAK ADA MAKA LOAD DATA MASTER YANG DISIMPAN KE LOCALSTORAGE KE UI USER
         /*
            - LOAD DATA MASTER SERVER KE ELEMENT SELECT SERVER DEX
            - LOAD DATA MASTER LIST TOKEN KETABLE
            - SERVER YANG DIPILIH
            - SPEED SCAN
            - MODAL KIRI & KANAN
            - PNL
            - SERVER LIST
            - LIST TOKEN (SESUAI YANG DIPILIH - DISABLE & ENABLE)
            - DATA API 1INCH
         */
        // JIKA DATA SETINGAN APA PADA LOCAL STORAGE MAKA 
         /*
            - LOAD DATA SETINGAN KE ELEMENT SELECT SERVER DEX
            - LOAD DATA SETINGAN KETABLE
            - SERVER YANG DIPILIH
            - SPEED SCAN
            - MODAL KIRI & KANAN
            - PNL
            - SERVER LIST
            - LIST TOKEN (SESUAI YANG DIPILIH - DISABLE & ENABLE)
            - DATA API 1INCH
            - JIKA DATA MASTER KOSONG TAMPILKAN PESAN "SYNCRON DATA DAHULU"
         */
        if(localStorage.getItem('DATA_SETTING')){
          DATA = JSON.parse(localStorage.getItem('DATA_SETTING'))
           // Ambil daftar servercors dari localStorage
           var storedServercorsList = DATA.SERVERCORS;

          // Tampilkan kategori SERVERCORS ke dalam elemen <select> serverdex
          var selectElement = $('#serverdex');
          for (var i = 0; i < storedServercorsList.length; i++) {
              selectElement.append($('<option>', {
                  value: "SERVER"+(i + 1),
                  text: 'SERVER' + (i + 1)
              }));
          }
          $('#serverdex').val(DATA.selectServer)
          PILIHSERVERDEX (DATA.selectServer,false);
          PILIHDEX()
          console.log('data_setting')

          $('#mkiri').val(DATA.MODALKIRI);
          $('#mkanan').val(DATA.MODALKANAN);
          $('#idtele').val(DATA.ID_TELE);
          $('#netpnl').val(DATA.PNL);
          $('#delay').val(DATA.SPEED_SCAN);

        }else if(localStorage.getItem('DATA_MASTER')){
          DATA = JSON.parse(localStorage.getItem('DATA_SETTING'))
          
          PILIHSERVERDEX ("SERVER1",false);
          PILIHDEX()
          console.log('data_master')

          $('#mkiri').val(DATA.MODALKIRI);
          $('#mkanan').val(DATA.MODALKANAN);
          $('#idtele').val(DATA.ID_TELE);
          $('#netpnl').val(DATA.PNL);
          $('#delay').val(DATA.SPEED_SCAN);

        }else{
          alert('SINKRON DATA DAHULU')
        }

        tickers = DATA.LIST_TOKEN;
        
        var userAgent = navigator.userAgent;
        var extractedChars = userAgent.substring(30,45);
        localStorage.setItem('idx', extractedChars);

        // localStorage.setItem('jsonDataX', JSON.stringify(tickers));
        var coinData = DATA.LIST_TOKEN;

        // FUNGSI CHECKBOX DISABLE/ENABLE  COIN           
        $(document).on('click', '.statusCheckbox', function() {
                var coinData = DATA.LIST_TOKEN;   
                var index = $(this).data('index');
                var status = $(this).prop('checked');
                var namacoin =  coinData[index].symbol;
                
                coinData[index].status = status;

                alert("UBAH STATUS KOIN "+namacoin+ " BERHASIL!!");
                  // Save the updated data back to localStorage
                coinData = coinData;
                localStorage.setItem('DATA_SETTING', JSON.stringify({...DATA,LIST_TOKEN:coinData}));
        });

        $('.myCheckbox').on('change', function() {
          var listDEX= DATA.DEX

          if ($(this).prop('checked')) {
            listDEX.push($(this).attr('id'))
          } else {
            let index = listDEX.indexOf($(this).attr('id'));
            if (index !== -1) {
              listDEX.splice(index, 1);
            }
          }
          localStorage.setItem('DATA_SETTING', JSON.stringify({...DATA,DEX:listDEX}))
        });

        function PILIHDEX(){
          var dexs = DATA.DEX
          dexs.forEach(dex => {
            var checkbox = $('#' + dex);
            if (checkbox.length) {
              checkbox.prop('checked', true);
            }
          });
        }

      $("#delay").on("change", function() {
        var selectedDelay = $(this).val();
        PILIHDELAY(selectedDelay);
      });
      
      function PILIHDELAY(speed){
        // var speed = JSON.parse(localStorage.getItem('DATA_MASTER'));
        localStorage.setItem('DATA_SETTING', JSON.stringify({...DATA,SPEED_SCAN:speed}));
      }
      
      $("#serverdex").on("change", function() {
        var selectedServer = $(this).val();
        PILIHSERVERDEX(selectedServer,true);
      });

      function PILIHSERVERDEX(selectedServer, status){
          // var server = JSON.parse(localStorage.getItem('DATA_MASTER'));
          localStorage.setItem('DATA_SETTING', JSON.stringify({...DATA,selectServer:selectedServer}));
          if(status){
            alert("SERVER DEX SUDAH DIGANTI", localStorage.getItem('SERVERDEX'));
          }
          // Update the array based on the selected server
          if (selectedServer === "SERVER10") {
            updateServerArray(DATA.SERVERCORS[9]);
          } else if (selectedServer === "SERVER9") {
            updateServerArray(DATA.SERVERCORS[8]);
          }else if (selectedServer === "SERVER8") {
            updateServerArray(DATA.SERVERCORS[7]);
          }else if (selectedServer === "SERVER7") {
            updateServerArray(DATA.SERVERCORS[6]);
          }else if (selectedServer === "SERVER6") {
            updateServerArray(DATA.SERVERCORS[5]);
          }else if (selectedServer === "SERVER5") {
            updateServerArray(DATA.SERVERCORS[4]);
          } else if (selectedServer === "SERVER4") {
            updateServerArray(DATA.SERVERCORS[3]);
          }else if (selectedServer === "SERVER3") {
            updateServerArray(DATA.SERVERCORS[2]);
          }else if (selectedServer === "SERVER2") {
            updateServerArray(DATA.SERVERCORS[1]);
          }else if (selectedServer === "SERVER1") {
            updateServerArray(DATA.SERVERCORS[0]);
          }else{
            alert("SILAKAN PILIH SERVER DEX DAHULU!!");
          }
      }
       
      // ubah serverDEX
      function updateServerArray(serverArray) {
        for (var i = 0; i < 10; i++) {
              localStorage.setItem('SelectServerCORS_'+ (i + 1), serverArray[i]);
          }
      }
          
        $('#mkiri').val(DATA.MODALKIRI);
        $('#mkanan').val(DATA.MODALKANAN);
        $('#idtele').val(DATA.ID_TELE);

     if (localStorage.getItem('tokenx') != null) {
        $('#token').val(localStorage.getItem('tokenx'));
      }
    //  if (localStorage.getItem('api1INCHKiri') != null) {
    //     $('#api1INCHKiri').val(localStorage.getItem('api1INCHKiri'));
    //   }
    //   if (localStorage.getItem('api1INCHKanan') != null) {
    //     $('#api1INCHKanan').val(localStorage.getItem('api1INCHKanan'));
    //   }
    //   if (localStorage.getItem('api1INCHKiri2') != null) {
    //     $('#api1INCHKiri2').val(localStorage.getItem('api1INCHKiri2'));
    //   }
    //   if (localStorage.getItem('api1INCHKanan2') != null) {
    //     $('#api1INCHKanan2').val(localStorage.getItem('api1INCHKanan2'));
    //   }
    //   if (localStorage.getItem('api1INCHKiri21') != null) {
    //     $('#api1INCHKiri21').val(localStorage.getItem('api1INCHKiri21'));
    //   }
    //   if (localStorage.getItem('api1INCHKanan21') != null) {
    //     $('#api1INCHKanan21').val(localStorage.getItem('api1INCHKanan21'));
    //   }
    //   if (localStorage.getItem('api1INCHKiri22') != null) {
    //     $('#api1INCHKiri22').val(localStorage.getItem('api1INCHKiri22'));
    //   }
    //   if (localStorage.getItem('api1INCHKanan22') != null) {
    //     $('#api1INCHKanan22').val(localStorage.getItem('api1INCHKanan22'));
    //   }
    //   if (localStorage.getItem('api1INCHKiri31') != null) {
    //     $('#api1INCHKiri31').val(localStorage.getItem('api1INCHKiri31'));
    //   }
    //   if (localStorage.getItem('api1INCHKanan31') != null) {
    //     $('#api1INCHKanan31').val(localStorage.getItem('api1INCHKanan31'));
    //   }
      if(DATA.API1INCH){
        $('#api1INCHKiri').val(DATA.API1INCH[0]);
        $('#api1INCHKanan').val(DATA.API1INCH[1]);
        $('#api1INCHKiri2').val(DATA.API1INCH[2]);
        $('#api1INCHKanan2').val(DATA.API1INCH[3]);
        $('#api1INCHKiri21').val(DATA.API1INCH[4]);
        $('#api1INCHKanan21').val(DATA.API1INCH[5]);
        $('#api1INCHKiri22').val(DATA.API1INCH[6]);
        $('#api1INCHKanan22').val(DATA.API1INCH[7]);
        $('#api1INCHKiri31').val(DATA.API1INCH[8]);
        $('#api1INCHKanan31').val(DATA.API1INCH[9]);
      }

      if (localStorage.getItem('apiMATCHAKiri') != null) {
        $('#apiMATCHAKiri').val(localStorage.getItem('apiMATCHAKiri'));
      }
      if (localStorage.getItem('apiMATCHAKanan') != null) {
        $('#apiMATCHAKanan').val(localStorage.getItem('apiMATCHAKanan'));
      }
      if (localStorage.getItem('apiMATCHAKiri2') != null) {
        $('#apiMATCHAKiri2').val(localStorage.getItem('apiMATCHAKiri2'));
      }
      if (localStorage.getItem('apiMATCHAKanan2') != null) {
        $('#apiMATCHAKanan2').val(localStorage.getItem('apiMATCHAKanan2'));
      }

      function feeGasGwei(){
        // FETCH PRICE BNB
            $.getJSON('https://api.binance.me/api/v3/ticker/24hr', { symbol: "BNBUSDT" })
              .done(function(response) {
                localStorage.setItem('PriceBNB', response.lastPrice);
              })
              .fail(function(error) {
                console.log('Error calling BNBUSDT:', error);
              });

              $.getJSON('https://api.bscscan.com/api?module=gastracker&action=gasoracle&apikey=VTXAJJKJ7QUBPF8WYTQ36GD5UPM9W1J8CJ')
            .done(function(response) {
                localStorage.setItem('gasGWEI', response.result.ProposeGasPrice);
                var gasGWEI=localStorage.getItem('gasGWEI');
                var USDTGasBNB=((gasGWEI/1000000000)*260000)*localStorage.getItem('PriceBNB');
                localStorage.setItem('USDTGasBNB', USDTGasBNB);
                console.log("USDT GAS: "+USDTGasBNB);
                $('#gwei').html("GWEI GAS : "+ gasGWEI +" = "+ USDTGasBNB.toFixed(2) + "$ | Price BNB :" + parseFloat(localStorage.getItem('PriceBNB')).toFixed(2));
            })
            .fail(function(error) {
                console.log('Error calling GAS GWEI:', error);
            });
        }

          $("#pair").change(function () {
              var selectedValue = $(this).val();
              alert('Anda Mengganti PAIR: ' + selectedValue);
              // Panggil fungsi dengan nilai yang dipilih
              setPAIR(selectedValue);
          });

      function setPAIR(){
          var pair = $('input[name="radioOption"]:checked').val();
          switch (pair) {
            case 'BNB':
                var sc ='0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c';
                var des =18;
                var pair ="BNBUSDT";
                break;
              case 'USDC':
                var sc ='0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d';
                var des =18;
                var pair ="USDCUSDT";
                break;
              case 'BTC':
                var sc ='0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c';
                var des =18;
                var pair ="BTCUSDT";
                break;
              case 'FDUSD':
                var sc ='0xc5f0f7b66764f6ec8c8dff7ba683102295e16409';
                var des =18;
                var pair ="FDUSDUSDT";
                break;
              default:
                var sc ='0x55d398326f99059fF775485246999027B3197955';
                var des =18;
                var pair ="USDTUSDT";
                break;
            }
            localStorage.setItem('sc', sc);
            localStorage.setItem('des', des);
            localStorage.setItem('pair', pair);
            console.log("scnya :"+sc);
            console.log("des :"+des);
            console.log("pair :"+localStorage.getItem('pair'));

                    if(localStorage.getItem('pair')=="USDTUSDT"){
                        localStorage.setItem('PriceRate', 1);
                    }else{
                      $.ajax({
                      url: 'https://api.binance.me/api/v3/ticker/price',
                      data: {
                        symbol: localStorage.getItem('pair')
                      },
                        success : function(response) {
                            var PriceRate = response.price;
                            localStorage.setItem('RatePair',localStorage.getItem('pair'));
                            localStorage.setItem('PriceRate', PriceRate);
                          // console.log('Latest Rate Price:', PriceRate);
                        },

                      error: function(xhr, status, error) {
                        console.log('Error get Price Rate Pair:', error);
                      }
                    });
                    }
          }
     

    // BUTTON START SCAN
    $('#start').on('click', function() {
      /*
       SIMPAN DATA SETINGAN KE LOCALSTORAGE {
          -. SERVER YANG DIPILIH
          -. SPEED SCAN
          -. MODAL KIRI & KANAN
          -. PNL
          -. SERVER LIST
          -. LIST TOKEN (SESUAI YANG DIPILIH - DISABLE & ENABLE)
          -. DATA API 1INCH
       }
       lALU JALANKAN SESUAI DATA SETINGAN YANG TELAH DISIMPAN KE LOCALSTORAGE
      */

        // localStorage.setItem('idtele', $('#idtele').val());
        var lapi1inch = [
              $('#api1INCHKiri').val(),
              $('#api1INCHKanan').val(),
              $('#api1INCHKiri2').val(),
              $('#api1INCHKanan2').val(),
              $('#api1INCHKiri21').val(),
              $('#api1INCHKanan21').val(),
              $('#api1INCHKiri22').val(),
              $('#api1INCHKanan22').val(),
              $('#api1INCHKiri31').val(),
              $('#api1INCHKanan31').val()
            ]

            localStorage.setItem('DATA_SETTING', JSON.stringify({
              ...DATA,
              API1INCH: lapi1inch,
              ID_TELE: Number($('#idtele').val()),
              MODALKIRI: Number($('#mkiri').val()),
              MODALKANAN: Number($('#mkanan').val()),
              PNL: Number($('#netpnl').val()),
              SPEED_SCAN: Number($('#delay').val())
            }));

        $("#start").hide();
        $('input[type="text"]').prop('disabled', true);
        $('input[type="number"]').prop('disabled', true);
        $('input[type="checkbox"]').prop('disabled', true);
        $("#serverdex").prop("disabled", true);
        $("#tokenx").prop("disabled", true);
        $('input[type="radio"]').prop('disabled', true);
        $('#delay').prop('disabled', true);
          var allUnchecked = true;

            $('.myCheckbox').each(function() {
              if ($(this).is(':checked')) {
                allUnchecked = false;
                return false; // Exit the loop early if a checked checkbox is found
              }
            });

            $('.myCheckbox2').each(function() {
              if ($(this).is(':checked')) {
                allUnchecked = false;
                return false; // Exit the loop early if a checked checkbox is found
              }
            });

            if (allUnchecked) {
              alert("Silakan PILIH DEX / KIRI - KANAN!!");
              console.log('Semua checkbox tidak dicentang');
            } else {
              localStorage.setItem('sx', '1');
              cekselisih();
              console.log('Setidaknya satu checkbox dicentang');
            }
        });


      function cekselisih() {
        DATA = JSON.parse(localStorage.getItem('DATA_SETTING'))

       Elimit=0;
       ELP=0;
       Kiri1INCHError=0;
       Kanan1INCHError=0;
       KiriOPENError=0;
       KananOPENError=0;
       KiriPARAError=0;
       KananPARAError=0;
       KiriKYBERError=0;
       KananKYBERError=0;
       KiriODOSError=0;
       KananODOSError=0;

        var startTime = new Date().getTime();
        localStorage.setItem('startTime',startTime);
        localStorage.setItem('duration',0);
        
              localStorage.setItem('Kiri1INCHSinyal',0);
              localStorage.setItem('Kanan1INCHSinyal',0);
              localStorage.setItem('Kiri1INCHError',0);
              localStorage.setItem('Kanan1INCHError',0);

              localStorage.setItem('KiriOPENSinyal',0);
              localStorage.setItem('KananOPENSinyal',0);
              localStorage.setItem('KiriOPENError',0);
              localStorage.setItem('KananOPENError',0);

              localStorage.setItem('KiriPARASinyal',0);
              localStorage.setItem('KananPARASinyal',0);
              localStorage.setItem('KiriPARAError',0);
              localStorage.setItem('KananPARAError',0);

              localStorage.setItem('KiriKYBERSinyal',0);
              localStorage.setItem('KananKYBERSinyal',0);
              localStorage.setItem('KiriKYBERError',0);
              localStorage.setItem('KananKYBERError',0);

              localStorage.setItem('KiriODOSSinyal',0);
              localStorage.setItem('KananODOSSinyal',0);
              localStorage.setItem('KiriODOSError',0);
              localStorage.setItem('KananODOSError',0);

        $("#hasil").text(localStorage.getItem('SERVERDEX')+ " : PROSES SCANNING #"+localStorage.getItem('sx'));  
        $("#sinyalkiri").text("");
        $("#sinyalkanan").text("");

          feeGasGwei();
          setPAIR();
          $('tbody tr').remove();

            // Mengambil data dari localStorage setelah pemeriksaan
            // var coinData = JSON.parse(localStorage.getItem('jsonDataX'));

            // localStorage.setItem('mkiri', $('#mkiri').val());
            // localStorage.setItem('mkanan', $('#mkanan').val());
            // localStorage.setItem('netpnl', $('#netpnl').val());
            // localStorage.setItem('delay', $('#delay').val());

            // localStorage.setItem('api1INCHKiri', $('#api1INCHKiri').val());
            // localStorage.setItem('api1INCHKanan', $('#api1INCHKanan').val());

            // localStorage.setItem('api1INCHKiri2', $('#api1INCHKiri2').val());
            // localStorage.setItem('api1INCHKanan2', $('#api1INCHKanan2').val());

            // localStorage.setItem('api1INCHKiri21', $('#api1INCHKiri21').val());
            // localStorage.setItem('api1INCHKanan21', $('#api1INCHKanan21').val());

            // localStorage.setItem('api1INCHKiri22', $('#api1INCHKiri22').val());
            // localStorage.setItem('api1INCHKanan22', $('#api1INCHKanan22').val());

            // localStorage.setItem('api1INCHKiri31', $('#api1INCHKiri31').val());
            // localStorage.setItem('api1INCHKanan31', $('#api1INCHKanan31').val());

            

            localStorage.setItem('Kiri1INCHSinyal',0);
            localStorage.setItem('Kanan1INCHSinyal',0);
            localStorage.setItem('Kiri1INCHError',0);
            localStorage.setItem('Kanan1INCHError',0);

            localStorage.setItem('KiriOPENSinyal',0);
            localStorage.setItem('KananOPENSinyal',0);
            localStorage.setItem('KiriOPENError',0);
            localStorage.setItem('KananOPENError',0); 

            localStorage.setItem('KiriPARASinyal',0);
            localStorage.setItem('KananPARASinyal',0);
            localStorage.setItem('KiriPARAError',0);
            localStorage.setItem('KananPARAError',0); 

            localStorage.setItem('KiriKYBERSinyal',0);
            localStorage.setItem('KananKYBERSinyal',0);
            localStorage.setItem('KiriKYBERError',0);
            localStorage.setItem('KananKYBERError',0); 

            localStorage.setItem('KiriODOSSinyal',0);
            localStorage.setItem('KananODOSSinyal',0);
            localStorage.setItem('KiriODOSError',0);
            localStorage.setItem('KananODOSError',0); 

            $("#lKiri1INCHSinyal").text("");
            $("#lKanan1INCHSinyal").text("");
            $("#lKiri1INCHError").text("");
            $("#lKanan1INCHError").text("");

            $("#lKiriOPENSinyal").text("");
            $("#lKananOPENSinyal").text("");
            $("#lKiriOPENError").text("");
            $("#lKananOPENError").text("");

            $("#lKiriPARASinyal").text("");
            $("#lKananPARASinyal").text("");
            $("#lKiriPARAError").text("");
            $("#lKananPARAError").text("");

            $("#lKiriKYBERSinyal").text("");
            $("#lKananKYBERSinyal").text("");
            $("#lKiriKYBERError").text("");
            $("#lKananKYBERError").text("");

            $("#lKiriODOSSinyal").text("");
            $("#lKananODOSSinyal").text("");
            $("#lKiriODOSError").text("");
            $("#lKananODOSError").text("");

          //  $("#myTable").hide();

            
            if($('#autorun').prop('checked')){
              sendStatusTELE("AUTO",localStorage.getItem('sx'));
            }else{
              sendStatusTELE("START",localStorage.getItem('sx'));
            }
        // Perulangan dengan penundaan (delay)
            var delay = DATA.SPEED_SCAN;
            var sc = localStorage.getItem('sc');
            var des = localStorage.getItem('des');
            var pair = localStorage.getItem('pair');
            var no=0;

                function processSentIndex(index, delay,apikiri,apikanan,Server1INCHKiri,Server1INCHKanan) {
                    var coin = coinData[index];
                   // setTimeout(function() {
                        if (coin.status == true) {
                            no++;
                            var dataToken = {
                                no: no,
                                status: coin.status,
                                ratePair: pair,
                                pair: coin.symbol,
                                scFrom: coin.sc,
                                desFrom: coin.desimal,
                                scTo: sc,
                                desTo: des,
                                feeWD: coin.wd,
                                modalL: DATA.MODALKIRI,
                                modalR: DATA.MODALKANAN,
                                api1INCHKiri:apikiri,
                                api1INCHKanan:apikanan,
                                Server1INCHKiri:Server1INCHKiri,
                                Server1INCHKanan:Server1INCHKanan,
                            };
                            updateProgress(no, coin.symbol);
                            CekBinance(dataToken);
                            var a=index * delay;
                            console.log("RUNNING "+index+" | TIME "+a);
                       }
                    //   }, index * 300);
                 }

              var dataArray = coinData; // Ganti dengan data Anda
               
              function processGroup(group, groupIndex) {
                //   console.log('/n Kelompok ke-' + (groupIndex + 1));

                   for (var i = 0; i < group.length; i++) {
  
                         var a =(groupIndex * 5 + i);
                         console.log('Index Data Awal: ' + (groupIndex * 5 + i) + ', Nilai: ' + group[a]);
                           if (a % 5 === 0) {
                             processSentIndex(a, delay,DATA.API1INCH[0],DATA.API1INCH[1],localStorage.getItem('SelectServerCORS_5'),localStorage.getItem('SelectServerCORS_10'));
                           }else  if (a % 5 === 1) {
                             processSentIndex(a, delay,DATA.API1INCH[2],DATA.API1INCH[3],localStorage.getItem('SelectServerCORS_4'),localStorage.getItem('SelectServerCORS_9'));
                           } else if (a % 5 === 2) {
                             processSentIndex(a, delay,DATA.API1INCH[4],DATA.API1INCH[5],localStorage.getItem('SelectServerCORS_3'),localStorage.getItem('SelectServerCORS_8'));
                           }else if (a % 5 === 3) {
                             processSentIndex(a, delay,DATA.API1INCH[6],DATA.API1INCH[7],localStorage.getItem('SelectServerCORS_2'),localStorage.getItem('SelectServerCORS_7'));
                           } else if(a % 5 === 4){
                             processSentIndex(a, delay,DATA.API1INCH[8],DATA.API1INCH[9],localStorage.getItem('SelectServerCORS_1'),localStorage.getItem('SelectServerCORS_6'));
                           }
                          // console.log("jalan grup pay");
                       }    

                 //  console.log('---');
               }


                 var groupSize = 5; 
                 var totalGroups = Math.ceil(dataArray.length / groupSize);
                 processNextGroup(0);
                
                 function processNextGroup(groupIndex) {
                   if (groupIndex < totalGroups) {
                       var start = groupIndex * groupSize;
                       var end = Math.min(start + groupSize, dataArray.length);
                       var group = dataArray.slice(start, end);
                       processGroup(group, groupIndex);
                       setTimeout(function() {
                           processNextGroup(groupIndex + 1);
                       }, delay); // Tunggu 1 detik sebelum memproses kelompok berikutnya
                       console.log("jalan bagi grup pay");
                   }
               } 
                     
        };


        function CekBinance(dataInBinance){
            if(dataInBinance.status==true){
                var apiUrl = "https://api.binance.me/api/v3/ticker/bookTicker?symbol=" + dataInBinance.pair;
                // Panggil REST API
                $.ajax({
                    url: apiUrl, // Ganti dengan URL API
                    method: 'GET',
                    success : function(resBinance) {

                    var PriceRate = localStorage.getItem('PriceRate');
                    var RatePair = localStorage.getItem('RatePair');

                    var dataOutBinance={
                        no: dataInBinance.no,
                        idtele : localStorage.getItem('idtele'),
                        status : dataInBinance.status,
                        token : dataInBinance.pair,
                        RatePair : RatePair,
                        PriceRate : PriceRate,
                        bidPrice : resBinance.bidPrice,
                        askPrice : resBinance.askPrice,
                        scFrom : dataInBinance.scFrom,
                        desFrom : dataInBinance.desFrom,
                        scTo : dataInBinance.scTo,
                        desTo : dataInBinance.desTo,
                        jumlahL : dataInBinance.modalL/resBinance.askPrice,
                        jumlahR : dataInBinance.modalR/PriceRate,
                        modalL : dataInBinance.modalL,
                        modalR : dataInBinance.modalR,
                        feeWD : parseFloat(dataInBinance.feeWD*resBinance.askPrice).toFixed(2),
                        api1INCHKiri:dataInBinance.api1INCHKiri,
                        api1INCHKanan:dataInBinance.api1INCHKanan,
                        Server1INCHKiri:dataInBinance.Server1INCHKiri,
                        Server1INCHKanan:dataInBinance.Server1INCHKanan,
                        ServerPARAKiri:dataInBinance.ServerPARAKiri,
                        ServerPARAKanan:dataInBinance.ServerPARAKanan,
                        ServerODOSKiri:dataInBinance.ServerODOSKiri,
                        ServerODOSKanan:dataInBinance.ServerODOSKanan,
                        innetPNL:DATA.PNL,
                    }
                    console.log(dataOutBinance);

                    $("#info").css("color", "green");
                    $("#info").text("CEK PAIR - BINANCE : " + dataInBinance.pair +" [OK] " );

                    var linkStok= 'STOK [ <a href="https://bscscan.com/token/'+dataOutBinance.scFrom+'?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3" target="_blank"> 1 </a> | <a href="https://bscscan.com/token/'+dataOutBinance.scFrom+'?a=0xe2fc31F816A9b94326492132018C3aEcC4a93aE1" target="_blank"> 2 </a> ]';
                    var link=' <a href="https://bscscan.com/token/'+dataOutBinance.scFrom+'" target="_blank">[ SC ]</a>';
                    var statusChecked = dataOutBinance.status ? 'checked' : '';
                    var index =  dataOutBinance.no-1;

                    var row = $('<tr>');
                            row.append($('<td>').addClass("token").html(dataOutBinance.no));
                            row.append($('<td class=binance>').html("<a href= https://www.binance.me/en/trade/"+dataOutBinance.token+" target=_blank>"+dataOutBinance.askPrice+"</a>"));
                              // <br/> 1INCH:"+dataOutBinance.Server1INCHKiri.substring(8,13)+"| PARA:"+dataOutBinance.ServerPARAKiri.substring(8,13)+"| ODOS:"+dataOutBinance.ServerODOSKiri.substring(8,13)));  
                        
                              if ($('#kiri').is(':checked')) {
                                if ($('#1INCH').is(':checked')) {

                                    row.append($('<td id=sell1INCH'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=sellPNL1INCH'+dataOutBinance.token+'>').text(""));
                                    swapKe1INCH(dataOutBinance);
                                  } else{
                                     $('#myTable').find('th#1inchkiri').css("display","none");
                                  }

                                if ($('#OPEN').is(':checked')) { 
                                    row.append($('<td id=sellOPEN'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=sellPNLOPEN'+dataOutBinance.token+'>').text(""));
                                    swapKeOPEN(dataOutBinance);
                                }else{                              
                                    $('#myTable').find('th#openkiri').css("display","none");
                                } 

                                if ($('#PARA').is(':checked')) { 
                                    row.append($('<td id=sellPARA'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=sellPNLPARA'+dataOutBinance.token+'>').text(""));
                                    swapKePARA(dataOutBinance);
                                }else{                              
                                    $('#myTable').find('th#PARAkiri').css("display","none");
                                } 

                                if ($('#KYBER').is(':checked')) { 
                                      row.append($('<td id=sellKYBER'+dataOutBinance.token+'>').text(""));
                                      row.append($('<td id=sellPNLKYBER'+dataOutBinance.token+'>').text(""));
                                      swapKeKYBER(dataOutBinance);
                                }else{                              
                                      $('#myTable').find('th#KYBERkiri').css("display","none");
                                } 

                                if ($('#ODOS').is(':checked')) { 
                                      row.append($('<td id=sellODOS'+dataOutBinance.token+'>').text(""));
                                      row.append($('<td id=sellPNLODOS'+dataOutBinance.token+'>').text(""));
                                      swapKeODOS(dataOutBinance);
                                }else{                              
                                      $('#myTable').find('th#ODOSkiri').css("display","none");
                                } 

                              }else{
                                    $('#myTable').find('th#1inchkiri').css("display","none");
                                    $('#myTable').find('th#openkiri').css("display","none");
                                    $('#myTable').find('th#matchakiri').css("display","none");
                                    $('#myTable').find('th#PARAkiri').css("display","none");
                                    $('#myTable').find('th#KYBERkiri').css("display","none");
                              } 

                              row.append($('<td class=token>').css({"color":"white","text-align":"center"}).html("<input type=checkbox class=statusCheckbox data-index="+ index +"  " + statusChecked + ">  "+(dataOutBinance.token).replace("USDT", "")+"  "+link+" <br/>"+linkStok));

                            if ($('#kanan').is(':checked')) {
                                if ($('#1INCH').is(':checked')) {
                                    row.append($('<td id=buy1INCH'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=buyPNL1INCH'+dataOutBinance.token+'>').text(""));
                                    swapDari1INCH(dataOutBinance);
                                } else{
                                     $('#myTable').find('th#1inchkanan').css("display","none");
                                }

                                if ($('#OPEN').is(':checked')) {    
                                    row.append($('<td id=buyOPEN'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=buyPNLOPEN'+dataOutBinance.token+'>').text(""));
                                    swapDariOPEN(dataOutBinance);
                                }else{
                                    $('#myTable').find('th#openkanan').css("display","none");
                                }

                                if ($('#PARA').is(':checked')) {       
                                    row.append($('<td id=buyPARA'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=buyPNLPARA'+dataOutBinance.token+'>').text(""));
                                    swapDariPARA(dataOutBinance);
                                }else{
                                    $('#myTable').find('th#PARAkanan').css("display","none");
                                }

                                 if ($('#matcha').is(':checked')) { 
                                    row.append($('<td id=buyMATCHA'+dataOutBinance.token+'>').text(""));
                                    row.append($('<td id=buyPNLMATCHA'+dataOutBinance.token+'>').text(""));
                                    swapDariMatcha(dataOutBinance);
                                }else{                              
                                    $('#myTable').find('th#matchakanan').css("display","none");
                                } 

                                if ($('#KYBER').is(':checked')) { 
                                      row.append($('<td id=buyKYBER'+dataOutBinance.token+'>').text(""));
                                      row.append($('<td id=buyPNLKYBER'+dataOutBinance.token+'>').text(""));
                                      swapDariKYBER(dataOutBinance);
                                }else{                              
                                      $('#myTable').find('th#KYBERkanan').css("display","none");
                                } 

                                if ($('#ODOS').is(':checked')) { 
                                      row.append($('<td id=buyODOS'+dataOutBinance.token+'>').text(""));
                                      row.append($('<td id=buyPNLODOS'+dataOutBinance.token+'>').text(""));
                                      swapDariODOS(dataOutBinance);
                                }else{                              
                                      $('#myTable').find('th#ODOSKanan').css("display","none");
                                } 

                            }else{
                                    $('#myTable').find('th#1inchkanan').css("display","none");
                                    $('#myTable').find('th#openkanan').css("display","none");
                                    $('#myTable').find('th#matchakanan').css("display","none");
                                    $('#myTable').find('th#PARAkanan').css("display","none");
                                    $('#myTable').find('th#KYBERkanan').css("display","none");
                             }

                            row.append($('<td class=binance>').html("<a href= https://www.binance.me/en/trade/"+dataOutBinance.token+" target=_blank>"+dataOutBinance.bidPrice+"</a>"));
                              // <br/> 1INCH:"+dataOutBinance.Server1INCHKanan.substring(8,13)+"| PARA:"+dataOutBinance.ServerPARAKanan.substring(8,13)+"| ODOS:"+dataOutBinance.ServerODOSKanan.substring(8,13)));
                            $('#myTable').append(row);

                    },
                    error: function(xhr, status, error) {
                      $("#info").css("color", "red");
                      $("#info").text("CEK PAIR - BINANCE : " + dataInBinance.pair +" [FAILED] " );
                    console.error("Cek data binance gagal: " + error); 
                    }
                });
            }
            else{
                  console.log("KOIN "+dataInBinance.pair);
                  console.log("STATUS "+dataInBinance.status);
           }
        }

        function swapKe1INCH(dataIn1inch){
          var jumlahL = Math.pow(10, dataIn1inch.desFrom)*dataIn1inch.jumlahL;
          var jumlahL = BigInt(Math.round(Number(jumlahL)));
          var api1INCHKiri = dataIn1inch.api1INCHKiri;
          var Server1INCHKiri = dataIn1inch.Server1INCHKiri;
          var Kiri1INCHSinyal = parseInt(localStorage.getItem('Kiri1INCHSinyal'));

          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');

          var apiUrl =
                        Server1INCHKiri+"https://api.1inch.dev/swap/v5.2/56/quote?src="+dataIn1inch.scFrom+
                        "&dst="+dataIn1inch.scTo+
                        "&amount=" +
                        jumlahL+"&includeGas=true";
                    //    jumlahL+"&includeGas=true&protocols=PANCAKESWAP,VENUS,JULSWAP,BAKERYSWAP,BSC_ONE_INCH_LP,ACRYPTOS,BSC_DODO,APESWAP,SPARTAN_V2,VSWAP,VPEGSWAP,HYPERSWAP,BSC_DODO_V2,SWAPSWIPE,ELLIPSIS_FINANCE,BSC_NERVE,BSC_SMOOTHY_FINANCE,CHEESESWAP,PANCAKESWAP_V2,MDEX,WARDEN,WAULTSWAP,BSC_ONE_INCH_LIMIT_ORDER,BSC_ONE_INCH_LIMIT_ORDER_V2,ACSI_FINANCE,GAMBIT_FINANCE,JETSWAP,BSC_UNIFI,BSC_KYBER_DMM,BSC_BI_SWAP,BSC_DOPPLE,BABYSWAP,BSC_PMM2MM,WOOFI,BSC_ELK,BSC_SYNAPSE,BSC_AUTOSHARK,BSC_CAFE_SWAP,PLANET_FINANCE,BSC_ANNEX_FINANCE,BSC_ANNEX_SWAP,BSC_RADIOSHACK,BSC_KYBERSWAP_ELASTIC,BSC_FSTSWAP,BSC_NOMISWAP,BSC_CONE,BSC_KYBER_DMM_STATIC,WOMBATSWAP,BSC_NOMISWAP_STABLE,BSC_PANCAKESWAP_STABLE,BSC_BABYDOGE,BSC_THENA,BSC_WOOFI_V2,BSC_KYOTOSWAP,BSC_TRADERJOE,BSC_TRADERJOE_V2,BSC_UNISWAP_V3,BSC_TRIDENT,BSC_MAVERICK_V1,BSC_PANCAKESWAP_V3,BSC_THENA_V3,BSC_TRADERJOE_V2_1,BSC_NOMISWAPEPCS,BSC_USDFI,BSC_LEVEL_FINANCE,BSC_DODO_V3,BSC_SMARDEX,BSC_PMM13";

              console.log("URL KIRI 1INCH"+apiUrl);          
              $.ajax({
                url:apiUrl,
                method: 'GET',
                headers: {
                  'Content-Type': "application/json; charset=utf-8",
                  'Authorization': "Bearer " +api1INCHKiri
                },
                success: function(res1INCH) {

                $("#info1").css("color", "green");
                $("#info1").text("API: "+api1INCHKiri.substring(0,7)+" #STATUS KIRI: " + dataIn1inch.token +" [OK]" );

                var PNL = ((res1INCH.toAmount/Math.pow(10,dataIn1inch.desTo))*dataIn1inch.PriceRate)-dataIn1inch.modalL;
                var harga1INCH =(Number(dataIn1inch.modalL)+PNL)/(dataIn1inch.modalL/dataIn1inch.askPrice);
                var FeeSwap = ((res1INCH.gas/ Math.pow(10, 9))*gasGWEI)*PriceBNB;

                var persen = ((harga1INCH - dataIn1inch.askPrice)/dataIn1inch.askPrice)*100;
                var totalFeeKiri = parseFloat(dataIn1inch.modalL * 0.001) +parseFloat(dataIn1inch.feeWD)+parseFloat(FeeSwap) ;
                var netpnl = parseFloat(PNL-totalFeeKiri).toFixed(2);
                  
                    console.log(`----- 1INCH KIRI : ${dataIn1inch.token} --------`);
                    console.log(`MODAL : ${dataIn1inch.modalL} `);
                    console.log(`BINANCE BUY : ${dataIn1inch.askPrice} `);
                    console.log(`1INCH SELL : ${harga1INCH} `);
                    console.log(`FEE WD : ${dataIn1inch.feeWD} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`IN PNL : ${dataIn1inch.innetPNL} `);
                    console.log(`TOTAL FEE : ${totalFeeKiri} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`URL : ${apiUrl} `);
                    console.log(`--------------------------------------`);
                  

              var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KIRI",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKiri.toFixed(2),
                            FeeSwap : FeeSwap.toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataIn1inch.token,
                            scFrom: dataIn1inch.scFrom,
                            desFrom: dataIn1inch.desFrom,
                            scTo: dataIn1inch.scTo,
                            desTo: dataIn1inch.desTo,
                            buy : dataIn1inch.askPrice,
                            sell: harga1INCH.toFixed(7),
                            modalL:DATA.MODALKIRI
                        };

                        var text ="<a href=#sell1INCH"+dataIn1inch.token+">1INCH : </a> <a href='https://bscscan.com/token/" + dataOUT.scFrom +"' target=_blank>"+(dataIn1inch.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/withdrawal/crypto/"+(dataIn1inch.token).replace("USDT", "")+"' target=_blank> [WD] </a> <br/>";
                        var sinyal = parseInt(localStorage.getItem('Kiri1INCHSinyal'))+1 ;
                        var text1 ="<a href='https://app.1inch.io/#/56/classic/swap/"+dataOUT.scFrom+"/"+dataOUT.scTo +"' target=_blank>"+harga1INCH.toFixed(7)+" </a> <br/> Fee:"+totalFeeKiri.toFixed(2)+"$";
                        var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                        var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                        var text13 = "1INCH : <a href=#sell1INCH"+dataIn1inch.token+">"+dataIn1inch.token+" </a> PNL:"+PNL.toFixed(2)+"$ <br/>";
                        
                        var message =
                           "MULTISCAN-<b>"+localStorage.getItem('idserver')+":1INCH#"+sinyal+"</b>"+" \n -----------------------------------------"+
                            " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scFrom +"'>[ SC ]</a>"+
                            "  <a href='https://bscscan.com/token/"+dataOUT.scFrom+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                           // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                            " \n MODAL : <b> "+ dataOUT.modalL + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                            " \n <b>BUY : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.buy +"</a>"+
                            " \n <b>SELL : </b> <a href='https://app.1inch.io/#/56/classic/swap/" +dataOUT.scFrom +"/" +dataOUT.scTo +"'>" +dataOUT.sell +"</a>"+
                            " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                            " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                            //" \n FEE Total : <b>" + dataOUT.totalfee +"$</b>"+
                            " \n -----------------------------------------";

                        if($('#checkboxFilter').is(':checked')) {
                            if (PNL > dataIn1inch.innetPNL) {
                             
                              $('#sinyalkiri').append(text);
                              var currentRow = $('#sell1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text1).addClass('inch');
                              var currentRow = $('#sellPNL1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text3).addClass('inch');
                              currentRow.append();

                              var jKiri1INCHSinyal = Kiri1INCHSinyal+1;
                              localStorage.setItem("Kiri1INCHSinyal",jKiri1INCHSinyal)
                              $("#lKiri1INCHSinyal").text(localStorage.getItem('Kiri1INCHSinyal'));
                               MultisendMessage(message);
                            }else{
                              var currentRow = $('#sell1INCH'+dataIn1inch.token).css({"text-align":"center"}).html(text1).addClass('inch');
                              var currentRow = $('#sellPNL1INCH'+dataIn1inch.token).css({"text-align":"center"}).html(text3).addClass('inch');
                              currentRow.append();
                            }
                          } else {
                            if (!isNaN(netpnl) && netpnl > totalFeeKiri){
                             
                              $('#sinyalkiri').append(text);
                              var currentRow = $('#sell1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text1).addClass('inch');
                              var currentRow = $('#sellPNL1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text3).addClass('inch');
                              currentRow.append();

                             var jKiri1INCHSinyal = Kiri1INCHSinyal+1;
                              localStorage.setItem("Kiri1INCHSinyal",jKiri1INCHSinyal)
                              $("#lKiri1INCHSinyal").text(localStorage.getItem('Kiri1INCHSinyal')); 
                              MultisendMessage(message);
                            }else{
                              var currentRow = $('#sell1INCH'+dataIn1inch.token).html(text1).addClass('inch');
                              var currentRow = $('#sellPNL1INCH'+dataIn1inch.token).html(text3).addClass('inch');
                              currentRow.append();
                            }

                        };

                },
                error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                                if(errorMessage==="insufficient liquidity"){
                                    var alert1="NO LP";
                                     ELP=ELP+1;

                                    localStorage.setItem("ELP",ELP);
                                 //   $("#ErrorLP").text("#ERROR NO LP : "+localStorage.getItem('ELP'));
                                }
                              // var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {                           
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    } else if (jqXHR.status === 429){
                        var alert1="KENA LIMIT";
                         Elimit=Elimit+1;

                        localStorage.setItem("Elimit",Elimit);
                       // $("#ErrorLimit").text("#ERROR LIMIT API : "+localStorage.getItem('Elimit'));
                    }else if (jqXHR.status === 200){
                          var alert1="ERROR";
                    }else {
                       console.log("xxxxx",jqXHR);
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }
                    Kiri1INCHError =Kiri1INCHError+1;
                    localStorage.setItem("Kiri1INCHError",Kiri1INCHError)

                    var currentRow = $('#sell1INCH'+dataIn1inch.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('Kiri1INCHError')+"");
                    var currentRow = $('#sellPNL1INCH'+dataIn1inch.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#lKiri1INCHError").text(localStorage.getItem('Kiri1INCHError'));
                   // alert("error kiri 1inch"+localStorage.getItem('Kiri1INCHError'));
                    $("#info1").css("color", "red");
                    $("#info1").text("STATUS KIRI: " + dataIn1inch.token +" [ "+alert1+"]" );
                    console.error("Cek data 1INCH gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapDari1INCH(dataIn1inch){
          var jumlahR = Math.pow(10, dataIn1inch.desTo)*dataIn1inch.jumlahR;
          var jumlahR = BigInt(Math.round(Number(jumlahR)));
          var api1INCHKanan = dataIn1inch.api1INCHKanan;
          var Server1INCHKanan = dataIn1inch.Server1INCHKanan;
          var Kanan1INCHSinyal = parseInt(localStorage.getItem('Kanan1INCHSinyal'));
         // var Kanan1INCHError =parseInt(localStorage.getItem('Kanan1INCHError'));
         //var Elimit =parseInt(localStorage.getItem('Elimit'));
         // var ELP =parseInt(localStorage.getItem('ELP'));
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          
          var apiUrl =
                        Server1INCHKanan+"https://api.1inch.dev/swap/v5.2/56/quote?src="+dataIn1inch.scTo+
                        "&dst="+dataIn1inch.scFrom+
                        "&amount=" +
                      jumlahR+"&includeGas=true";
        //              jumlahR+"&includeGas=true&protocols=PANCAKESWAP,VENUS,JULSWAP,BAKERYSWAP,BSC_ONE_INCH_LP,ACRYPTOS,BSC_DODO,APESWAP,SPARTAN_V2,VSWAP,VPEGSWAP,HYPERSWAP,BSC_DODO_V2,SWAPSWIPE,ELLIPSIS_FINANCE,BSC_NERVE,BSC_SMOOTHY_FINANCE,CHEESESWAP,PANCAKESWAP_V2,MDEX,WARDEN,WAULTSWAP,BSC_ONE_INCH_LIMIT_ORDER,BSC_ONE_INCH_LIMIT_ORDER_V2,ACSI_FINANCE,GAMBIT_FINANCE,JETSWAP,BSC_UNIFI,BSC_KYBER_DMM,BSC_BI_SWAP,BSC_DOPPLE,BABYSWAP,BSC_PMM2MM,WOOFI,BSC_ELK,BSC_SYNAPSE,BSC_AUTOSHARK,BSC_CAFE_SWAP,PLANET_FINANCE,BSC_ANNEX_FINANCE,BSC_ANNEX_SWAP,BSC_RADIOSHACK,BSC_KYBERSWAP_ELASTIC,BSC_FSTSWAP,BSC_NOMISWAP,BSC_CONE,BSC_KYBER_DMM_STATIC,WOMBATSWAP,BSC_NOMISWAP_STABLE,BSC_PANCAKESWAP_STABLE,BSC_BABYDOGE,BSC_THENA,BSC_WOOFI_V2,BSC_KYOTOSWAP,BSC_TRADERJOE,BSC_TRADERJOE_V2,BSC_UNISWAP_V3,BSC_TRIDENT,BSC_MAVERICK_V1,BSC_PANCAKESWAP_V3,BSC_THENA_V3,BSC_TRADERJOE_V2_1,BSC_NOMISWAPEPCS,BSC_USDFI,BSC_LEVEL_FINANCE,BSC_DODO_V3,BSC_SMARDEX,BSC_PMM13";

            //console.log("URL 1inH KANAN : "+apiUrl);      
              $.ajax({
                url:apiUrl,
                method: 'GET',
                headers: {
                  'Content-Type': "application/json; charset=utf-8",
                  'Authorization': "Bearer " +api1INCHKanan
                },
                success: function(res1INCH) {

                  $("#info2").css("color", "green");
                  $("#info2").text("API: "+api1INCHKanan.substring(0,7)+" #STATUS KANAN : " + dataIn1inch.token +" [OK]" );

                  var harga1INCH = (dataIn1inch.modalR / (res1INCH.toAmount / Math.pow(10, dataIn1inch.desFrom)));
                  var PNL =((dataIn1inch.modalR/ harga1INCH)*dataIn1inch.bidPrice)-dataIn1inch.modalR;
                  var persen = ((dataIn1inch.bidPrice-harga1INCH)/dataIn1inch.bidPrice)*100;
                  var FeeSwap = ((res1INCH.gas/ Math.pow(10, 9))*gasGWEI)*PriceBNB;
                  var totalFeeKanan = parseFloat(dataIn1inch.modalR * 0.001) + parseFloat(FeeSwap) ;
                  var netpnl = parseFloat(PNL-totalFeeKanan).toFixed(2);
                  var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";

                      console.log(`----- 1INCH KANAN ${dataIn1inch.token} --------`);
                      console.log(`MODAL : ${dataIn1inch.modalR} `);
                      console.log(`1INCH BUY : ${harga1INCH} `);
                      console.log(`BINANCE SELL : ${dataIn1inch.bidPrice} `);
                      console.log(`TOTAL FEE : ${totalFeeKanan} `);
                      console.log(`PNL : ${PNL} `);
                      console.log(`NET PNL : ${netpnl} `);
                      console.log(`FEE SWAP : ${FeeSwap} `);
                      console.log(`Prosentase : ${persen} `);
                      console.log(`URL : ${apiUrl} `);
                      console.log(`--------------------------------------`)
                  

                              var dataOUT = {
                                  idserver: localStorage.getItem('idserver'),
                                  market : "KANAN",
                                  PNL : PNL.toFixed(2),
                                  netPNL : netpnl,
                                  totalfee : totalFeeKanan.toFixed(2),
                                  FeeSwap : FeeSwap.toFixed(2),
                                  persen : persen.toFixed(2),
                                  pair: dataIn1inch.token,
                                  scTo: dataIn1inch.scFrom,
                                  desTo: dataIn1inch.desFrom,
                                  scFrom: dataIn1inch.scTo,
                                  desFrom: dataIn1inch.desTo,
                                  sell : dataIn1inch.bidPrice,
                                  buy : harga1INCH.toFixed(7),
                                  modalR:DATA.MODALKANAN
                              };

                        
                          var text ="<a href=#buy1INCH"+dataIn1inch.token+"> 1INCH : </a>  <a href='https://bscscan.com/token/" + dataOUT.scTo +"' target=_blank>"+(dataIn1inch.token).replace("USDT", "")+"</a>  PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataIn1inch.token).replace("USDT", "")+"' target=_blank> [DP] </a> <br/>"; 
                          var sinyal =parseInt(localStorage.getItem('Kanan1INCHSinyal'))+1 ;
                          var text1 ="<a href='https://app.1inch.io/#/56/classic/swap/" +dataOUT.scFrom +"/" +dataOUT.scTo +"' target=_blank>"+harga1INCH.toFixed(7)+"<br/> Fee:"+totalFeeKanan.toFixed(2)+"$";
                          var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                          var text13 = "1INCH : <a href=#sell1INCH"+dataIn1inch.token+">"+dataIn1inch.token+" </a>  PNL:"+PNL.toFixed(2)+"$ <br/>"; 

                          var message =
                           "MULTISCAN-<b>"+localStorage.getItem('idserver')+":1INCH#"+sinyal+"</b>"+" \n -----------------------------------------"+
                            " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scTo +"'>[ SC ]</a>"+
                            "  <a href='https://bscscan.com/token/"+dataOUT.scTo+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                          // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                            " \n MODAL : <b> "+ dataOUT.modalR + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                            " \n <b>BUY : </b> <a href='https://app.1inch.io/#/56/classic/swap/" +dataOUT.scTo +"/" +dataOUT.scFrom +"'>" +dataOUT.buy +"</a>"+
                            " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.sell +"</a>"+
                            " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                            " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                            " \n -----------------------------------------";

                          if($('#checkboxFilter').is(':checked')) {
                              if (PNL > dataIn1inch.innetPNL) {
                                
                                $('#sinyalkanan').append(text);
                                var currentRow = $('#buy1INCH'+dataIn1inch.token).html(text1).css({"background-color":"green","color": "white"}).addClass('inch');
                                var currentRow = $('#buyPNL1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text3).addClass('inch');
                                currentRow.append();

                                var jKanan1INCHSinyal = Kanan1INCHSinyal+1;
                                localStorage.setItem("Kanan1INCHSinyal",jKanan1INCHSinyal)
                                $("#lKanan1INCHSinyal").text(localStorage.getItem('Kanan1INCHSinyal'));
                                MultisendMessage(message);
                              }else{
                                var currentRow = $('#buy1INCH'+dataIn1inch.token).css({"text-align":"center"}).html(text1).addClass('inch');
                                var currentRow = $('#buyPNL1INCH'+dataIn1inch.token).css({"text-align":"center"}).html(text3).addClass('inch');
                              }
                            } else {
                              if ( !isNaN(PNL) && netpnl > totalFeeKanan ){
                                
                                $('#sinyalkanan').append(text);
                                var currentRow = $('#buy1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text1).addClass('inch');
                                var currentRow = $('#buyPNL1INCH'+dataIn1inch.token).css({"background-color":"green","color": "white"}).html(text3).addClass('inch');
                                currentRow.append();

                                var jKanan1INCHSinyal = Kanan1INCHSinyal+1;
                                localStorage.setItem("Kanan1INCHSinyal",jKanan1INCHSinyal)
                                $("#lKanan1INCHSinyal").text(localStorage.getItem('Kanan1INCHSinyal'));
                                MultisendMessage(message);
                              }else{
                                var currentRow = $('#buy1INCH'+dataIn1inch.token).html(text1).addClass('inch');
                                var currentRow = $('#buyPNL1INCH'+dataIn1inch.token).html(text3).addClass('inch');
                                currentRow.append();
                              }

                          };
               
              //  console.log(`Cek data 1INCH berhasil!!`);
                },
                error: function(jqXHR, textStatus, errorThrown) {

                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                               var errorMessage = errorResponse.description;
                               if(errorMessage==="insufficient liquidity"){
                                 var alert1="NO LP";
                                 ELP=ELP+1;
                                 localStorage.setItem("ELP",ELP);
                               //  $("#ErrorLP").text("#ERROR NO LP : "+localStorage.getItem('ELP'));
                               }
                               //var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    } else if (jqXHR.status === 429){
                          var alert1="KENA LIMIT";
                          Elimit=Elimit+1;

                          localStorage.setItem("Elimit",Elimit);
                        //  $("#ErrorLimit").text("#ERROR LIMIT API : "+localStorage.getItem('Elimit'));

                    }else {
                        console.log("xxxx ",jqXHR);
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }
                    Kanan1INCHError =Kanan1INCHError+1;
                    console.log("error kanan"+Kanan1INCHError);
                    localStorage.setItem("Kanan1INCHError",Kanan1INCHError)

                    var currentRow = $('#buy1INCH'+dataIn1inch.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('Kanan1INCHError')+"").remove;
                    var currentRow = $('#buyPNL1INCH'+dataIn1inch.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#lKanan1INCHError").text(localStorage.getItem('Kanan1INCHError'));

                    $("#info2").css("color", "red");
                    $("#info2").text("STATUS KANAN : " + dataIn1inch.token +" [ "+alert1+"]" );
                    console.error("Cek data 1INCH gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                    
                },timeout: 12000
            });
        }

        function swapKeOPEN(dataInOPEN){
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          var KiriOPENSinyal = parseInt(localStorage.getItem('KiriOPENSinyal'));
         
          var apiUrl =
                        "https://open-api.openocean.finance/v3/bsc/quote?inTokenAddress=" +
                        dataInOPEN.scFrom +
                        "&outTokenAddress=" +
                        dataInOPEN.scTo +
                        "&gasPrice="+4+"&slippage=0.5&amount=" +
                        dataInOPEN.jumlahL;
            console.log("OPEN :" +dataInOPEN);
            // Panggil REST API
            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(resOPEN) {

                $("#info12").css("color", "green");
                $("#info12").text("STATUS KIRI : " + dataInOPEN.token +" [OK]" );
                // PNL open adlah resAmount/ des source *(rate))
                var PNL = ((resOPEN.data.outAmount/Math.pow(10,dataInOPEN.desTo))*dataInOPEN.PriceRate)-dataInOPEN.modalL;
              // harga =(modalL+PNL)/(modalL/binanceask)
                var hargaOPEN =(Number(dataInOPEN.modalL)+PNL)/(dataInOPEN.modalL/dataInOPEN.askPrice);
                var FeeSwap = ((resOPEN.data.estimatedGas/ Math.pow(10, 9))*gasGWEI)*PriceBNB;
                var persen = ((hargaOPEN - dataInOPEN.askPrice)/dataInOPEN.askPrice)*100;
                var totalFeeKiri = parseFloat(dataInOPEN.modalL * 0.001) +parseFloat(dataInOPEN.feeWD)+parseFloat(FeeSwap);
                var netpnl = parseFloat(PNL-totalFeeKiri).toFixed(2);
              // if(PNL>10){
                // total fee = 0.04+0.4 + 0.1 = 0.45 --> netpnl = pnl-totalfee
                //    console.log(`TOKEN ${dataInOPEN.token}`);
                    console.log(`----- OPEN KIRI : ${dataInOPEN.token} --------`);
                    console.log(`BINANCE BUY : ${dataInOPEN.askPrice} `);
                    console.log(`OPEN SELL : ${hargaOPEN} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`FEE WD : ${dataInOPEN.feeWD} `);
                    console.log(`TOTAL FEE : ${totalFeeKiri} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`--------------------------------------`);

              //console.log("fee total:"+totalFeeKiri);
                     var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KIRI",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKiri.toFixed(2),
                            FeeSwap : FeeSwap.toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataInOPEN.token,
                            scFrom: dataInOPEN.scFrom,
                            desFrom: dataInOPEN.desFrom,
                            scTo: dataInOPEN.scTo,
                            desTo: dataInOPEN.desTo,
                            buy : dataInOPEN.askPrice,
                            sell: hargaOPEN.toFixed(7),
                            modalL:DATA.MODALKIRI
                        };

                        var text ="<a href=#sellOPEN"+dataInOPEN.token+">OPEN  :  </a>  <a href='https://bscscan.com/token/" + dataOUT.scFrom +"' target=_blank>"+(dataInOPEN.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/withdrawal/crypto/"+(dataInOPEN.token).replace("USDT", "")+"' target=_blank> [WD] </a> <br/>";
                        var sinyal =parseInt(localStorage.getItem('KiriOPENSinyal'))+1;
                        var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaOPEN.toFixed(7)+" </a> <br/> Fee:"+totalFeeKiri.toFixed(2)+"$";
                        var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                        var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                        var text13 ="OPEN  : <a href=#sellOPEN"+dataInOPEN.token+">"+dataInOPEN.token+" </a> PNL:"+PNL.toFixed(2)+"$ <br/>";

                        var message =
                       "MULTISCAN-<b>"+localStorage.getItem('idserver')+":OPEN#"+sinyal+"</b>"+" \n -----------------------------------------"+
                        " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scFrom +"'>[ SC ]</a>"+
                        " <a href='https://bscscan.com/token/"+dataOUT.scFrom+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                       // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                        " \n MODAL : <b> "+ dataOUT.modalL + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                        " \n <b>BUY : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.buy +"</a>"+
                        " \n <b>SELL : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.sell+"</a>"+
                        " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                        " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                        //" \n FEE Total : <b>" + dataOUT.totalfee +"$</b>"+
                        " \n -----------------------------------------";

                if($('#checkboxFilter').is(':checked')) {
                      if (PNL > parseFloat(dataInOPEN.innetPNL)) {
                       
                        $('#sinyalkiri').append(text);
                          var currentRow = $('#sellOPEN'+dataInOPEN.token).html(text1).css({"background-color":"green","color": "white"}).addClass('open');
                          var currentRow = $('#sellPNLOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text3).addClass('open');
                          currentRow.append();

                          var jKiriOPENSinyal = KiriOPENSinyal+1;
                          localStorage.setItem("KiriOPENSinyal",jKiriOPENSinyal)
                          $("#lKiriOPENSinyal").text(localStorage.getItem('KiriOPENSinyal')); 
                          MultisendMessage(message);
                     }else{
                         var currentRow = $('#sellOPEN'+dataInOPEN.token).css({"text-align":"center"}).html(text1).addClass('open');
                         var currentRow = $('#sellPNLOPEN'+dataInOPEN.token).css({"text-align":"center"}).html(text3).addClass('open');
                         currentRow.append();
                      }
                      
                  }else{
                        if (netpnl > totalFeeKiri){
                         
                          $('#sinyalkiri').append(text);
                          var currentRow = $('#sellOPEN'+dataInOPEN.token).html(text1).css({"background-color":"green","color": "white"}).addClass('open');
                          var currentRow = $('#sellPNLOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text3).addClass('open');
                          currentRow.append();

                          var jKiriOPENSinyal = KiriOPENSinyal+1;
                          localStorage.setItem("KiriOPENSinyal",jKiriOPENSinyal)
                          $("#lKiriOPENSinyal").text(localStorage.getItem('KiriOPENSinyal')); 
                          MultisendMessage(message);
                        }else{
                          var currentRow = $('#sellOPEN'+dataInOPEN.token).html(text1).addClass('open');
                          var currentRow = $('#sellPNLOPEN'+dataInOPEN.token).html(text3).addClass('open');
                          currentRow.append();
                        }
                   }



              //  console.log(`Cek data OPEN berhasil!!`);
                },
                  error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                               var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    }else if (jqXHR.status === 429){
                         var alert1="KENA LIMIT";
                    }else {
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }

                    KiriOPENError = KiriOPENError+1;
                    localStorage.setItem("KiriOPENError",KiriOPENError)
                    $("#lKiriOPENError").text(localStorage.getItem('KiriOPENError'));

                    var currentRow = $('#sellOPEN'+dataInOPEN.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KiriOPENError')+"");
                    var currentRow = $('#sellPNLOPEN'+dataInOPEN.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#info12").css("color", "red");
                    $("#info12").text("STATUS KIRI : " + dataInOPEN.token +" [FAILED]" );
                    console.error("Cek data OPEN gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapDariOPEN(dataInOPEN){
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          var KananOPENSinyal = parseInt(localStorage.getItem('KananOPENSinyal'));
         
          var apiUrl =
                        "https://open-api.openocean.finance/v3/bsc/quote?outTokenAddress=" +
                        dataInOPEN.scFrom +
                        "&inTokenAddress=" +
                        dataInOPEN.scTo +
                        "&gasPrice="+4+"&slippage=0.5&amount=" +
                        dataInOPEN.jumlahR;
           // console.log("OPEN KANAN :" +apiUrl);
            // Panggil REST API
            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(resOPEN) {

                $("#info22").css("color", "green");
                $("#info22").text("STATUS KANAN : " + dataInOPEN.token +" [OK]" );

                var hargaOPEN =(dataInOPEN.modalR/dataInOPEN.PriceRate)/(resOPEN.data.outAmount/(Math.pow(10,dataInOPEN.desFrom))/dataInOPEN.PriceRate);
                var PNL = ((resOPEN.data.outAmount/Math.pow(10,dataInOPEN.desFrom))*dataInOPEN.bidPrice)-dataInOPEN.modalR;

                var FeeSwap = ((resOPEN.data.estimatedGas/ Math.pow(10, 9))*gasGWEI)*PriceBNB;
                var persen = ((dataInOPEN.askPrice-hargaOPEN)/dataInOPEN.askPrice)*100;
                var totalFeeKanan = parseFloat(dataInOPEN.modalR * 0.001) +parseFloat(FeeSwap);
                var netpnl = parseFloat(PNL-totalFeeKanan).toFixed(2);
              // if(PNL>10){
                //    console.log(`TOKEN ${dataInOPEN.token}`);
                    console.log(`----- OPEN KANAN : ${dataInOPEN.token} --------`);
                    console.log(`BINANCE BUY : ${dataInOPEN.askPrice} `);
                    console.log(`OPEN SELL : ${hargaOPEN} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`FEE WD : ${dataInOPEN.feeWD} `);
                    console.log(`TOTAL FEE : ${totalFeeKanan} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`--------------------------------------`);

              //console.log("fee total:"+totalFeeKiri);
                     var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KANAN",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKanan.toFixed(2),
                            FeeSwap : FeeSwap.toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataInOPEN.token,
                            scTo: dataInOPEN.scFrom,
                            desTo: dataInOPEN.desFrom,
                            scFrom: dataInOPEN.scTo,
                            desFrom: dataInOPEN.desTo,
                            sell : dataInOPEN.askPrice,
                            buy : hargaOPEN.toFixed(7),
                            modalR:DATA.MODALKANAN
                        };
 
               var text ="<a href=#buyOPEN"+dataInOPEN.token+">OPEN : </a>  <a href='https://bscscan.com/token/" + dataOUT.scTo +"' target=_blank>"+(dataInOPEN.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataInOPEN.token).replace("USDT", "")+"' target=_blank> [DP] </a><br/>";
               var sinyal =parseInt(localStorage.getItem('KananOPENSinyal')+1);
               var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaOPEN.toFixed(7)+"<br/> Fee:"+totalFeeKanan.toFixed(2)+"$";
               var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
               var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
               var text13 ="OPEN : <a href=#buyOPEN"+dataInOPEN.token+">"+dataInOPEN.token+"</a> PNL :"+PNL.toFixed(2)+"$ <br/>";

               var message =
                         "MULTISCAN-<b>"+localStorage.getItem('idserver')+":OPEN#"+sinyal+"</b>"+" \n -----------------------------------------"+
                          " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scTo +"'>[ SC ]</a>"+
                          "  <a href='https://bscscan.com/token/"+dataOUT.scTo+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                         // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                          " \n MODAL : <b> "+ dataOUT.modalR + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                          " \n <b>BUY : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.buy +"</a>"+
                          " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.sell +"</a>"+
                          " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                          " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                          " \n -----------------------------------------";

                if($('#checkboxFilter').is(':checked')) {
                 
                      if (PNL > parseFloat(dataInOPEN.innetPNL)) {
                       
                        $('#sinyalkanan').append(text);
                          var currentRow = $('#buyOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text1).addClass('open');
                          var currentRow = $('#buyPNLOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text3).addClass('open');
                          currentRow.append();

                          var jKananOPENSinyal = KananOPENSinyal+1;
                          localStorage.setItem("KananOPENSinyal",jKananOPENSinyal)
                          $("#lKananOPENSinyal").text(localStorage.getItem('KananOPENSinyal'));
                          MultisendMessage(message);
                     }else{
                         var currentRow = $('#buyOPEN'+dataInOPEN.token).css({"text-align":"center"}).html(text1).addClass('open');
                         var currentRow = $('#buyPNLOPEN'+dataInOPEN.token).css({"text-align":"center"}).html(text3).addClass('open');
                         currentRow.append();
                        }
                  }else{
                    console.log("itu")
                        if (netpnl > totalFeeKanan){
                          $('#sinyalkanan').append(text);
                        
                          var currentRow = $('#buyOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text1).addClass('open');
                          var currentRow = $('#buyPNLOPEN'+dataInOPEN.token).css({"background-color":"green","color": "white"}).html(text3).addClass('open');
                          currentRow.append();

                          var jKananOPENSinyal = KananOPENSinyal+1;
                          localStorage.setItem("KananOPENSinyal",jKananOPENSinyal)
                          $("#lKananOPENSinyal").text(localStorage.getItem('KananOPENSinyal'));
                          MultisendMessage(message);
                        }else{
                          var currentRow = $('#buyOPEN'+dataInOPEN.token).html(text1).addClass('open');
                          var currentRow = $('#buyPNLOPEN'+dataInOPEN.token).html(text3).addClass('open');
                          currentRow.append();
                        }
                   }

              //  console.log(`Cek data OPEN berhasil!!`);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                               var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    }else if (jqXHR.status === 429){
                                var alert1="KENA LIMIT";
                    } else {
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }
                    
                    KananOPENError = KananOPENError+1;
                    localStorage.setItem("KananOPENError",KananOPENError)
                    $("#lKananOPENError").text(localStorage.getItem('KananOPENError'));

                    var currentRow = $('#buyOPEN'+dataInOPEN.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KananOPENError')+"");
                    var currentRow = $('#buyPNLOPEN'+dataInOPEN.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#info22").css("color", "red");
                    $("#info22").text("STATUS KANAN : " + dataInOPEN.token +" [FAILED]" );
                    console.error("Cek data OPEN gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapKePARA(dataInPARA){
          var jumlahL = Math.pow(10, dataInPARA.desFrom)*dataInPARA.jumlahL;
          var jumlahL = BigInt(Math.round(Number(jumlahL)));
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          var KiriPARASinyal = parseInt(localStorage.getItem('KiriPARASinyal'));
          var ServerPARAKiri = dataInPARA.ServerPARAKiri;
         
          var apiUrl =
                        "https://apiv5.PARAswap.io/prices/?"+
                        "srcToken="+dataInPARA.scFrom+
                        "&srcDecimals="+dataInPARA.desFrom+
                        "&destToken="+dataInPARA.scTo+
                        "&destDecimals="+dataInPARA.desTo+
                        "&side=SELL&network=56"+
                        "&amount=" +
                        jumlahL;

            console.log("PARA URL:" +apiUrl);
            // Panggil REST API
            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(resPARA) {

                $("#info123").css("color", "green");
                $("#info123").text("KIRI : " + dataInPARA.token +" [OK]" );
                var PNL = ((resPARA.priceRoute.destAmount/Math.pow(10,dataInPARA.desTo))*dataInPARA.PriceRate)-dataInPARA.modalL;
                var hargaPARA =(Number(dataInPARA.modalL) + PNL)/(dataInPARA.modalL/dataInPARA.askPrice);
                var persen = ((hargaPARA - dataInPARA.askPrice)/dataInPARA.askPrice)*100;

                var FeeSwap = resPARA.priceRoute.gasCostUSD;
                var totalFeeKiri = parseFloat(dataInPARA.modalL * 0.001) +parseFloat(dataInPARA.feeWD)+parseFloat(FeeSwap);
                var netpnl = parseFloat(PNL-totalFeeKiri).toFixed(2);
              // if(PNL>10){
                // total fee = 0.04+0.4 + 0.1 = 0.45 --> netpnl = pnl-totalfee
                //    console.log(`TOKEN ${dataInPARA.token}`);
                    console.log(`----- PARA KIRI : ${dataInPARA.token} --------`);
                    console.log(`BINANCE BUY : ${dataInPARA.askPrice} `);
                    console.log(`PARA SELL : ${hargaPARA} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`FEE WD : ${dataInPARA.feeWD} `);
                    console.log(`TOTAL FEE : ${totalFeeKiri} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`--------------------------------------`);

              //console.log("fee total:"+totalFeeKiri);
                     var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KIRI",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKiri.toFixed(2),
                            FeeSwap :parseFloat(FeeSwap).toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataInPARA.token,
                            scFrom: dataInPARA.scFrom,
                            desFrom: dataInPARA.desFrom,
                            scTo: dataInPARA.scTo,
                            desTo: dataInPARA.desTo,
                            buy : dataInPARA.askPrice,
                            sell: hargaPARA.toFixed(7),
                            modalL:DATA.MODALKIRI
                        };

                        var text ="<a href=#sellPARA"+dataInPARA.token+">PARA : </a>  <a href='https://bscscan.com/token/" + dataOUT.scFrom +"' target=_blank>"+(dataInPARA.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/withdrawal/crypto/"+(dataInPARA.token).replace("USDT", "")+"' target=_blank> [WD] </a><br/>";
                        var sinyal =parseInt(localStorage.getItem('KiriPARASinyal'))+1;
                        var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaPARA.toFixed(7)+" </a> <br/> Fee:"+totalFeeKiri.toFixed(2)+"$";
                        var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";                        
                        var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                        var text13 ="PARA : <a href=#sellPARA"+dataInPARA.token+">"+dataInPARA.token+" </a> PNL:"+PNL.toFixed(2)+"$ <br/>";

                        var message =
                       "MULTISCAN-<b>"+localStorage.getItem('idserver')+":PARA#"+sinyal+"</b>"+" \n -----------------------------------------"+
                        " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scFrom +"'>[ SC ]</a>"+
                        " <a href='https://bscscan.com/token/"+dataOUT.scFrom+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                       // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                        " \n MODAL : <b> "+ dataOUT.modalL + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                        " \n <b>BUY : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.buy +"</a>"+
                        " \n <b>SELL : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.sell+"</a>"+
                        " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                          " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                        //" \n FEE Total : <b>" + dataOUT.totalfee +"$</b>"+
                        " \n -----------------------------------------";

                if($('#checkboxFilter').is(':checked')) {
                      if (PNL > dataInPARA.innetPNL) {
                       
                        $('#sinyalkiri').append(text);
                          var currentRow = $('#sellPARA'+dataInPARA.token).html(text1).css({"background-color":"green","color": "white"}).addClass('PARA');
                          var currentRow = $('#sellPNLPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text3).addClass('PARA');
                          currentRow.append();

                          var jKiriPARASinyal = KiriPARASinyal+1;
                          localStorage.setItem("KiriPARASinyal",jKiriPARASinyal)
                          $("#lKiriPARASinyal").text(localStorage.getItem('KiriPARASinyal')); 
                          MultisendMessage(message);
                     }else{
                         var currentRow = $('#sellPARA'+dataInPARA.token).css({"text-align":"center"}).html(text1).addClass('PARA');
                         var currentRow = $('#sellPNLPARA'+dataInPARA.token).css({"text-align":"center"}).html(text3).addClass('PARA');
                         currentRow.append();
                      }
                      
                  }else{
                        if (netpnl > totalFeeKiri){
                         
                          $('#sinyalkiri').append(text);
                          var currentRow = $('#sellPARA'+dataInPARA.token).html(text1).css({"background-color":"green","color": "white"}).addClass('PARA');
                          var currentRow = $('#sellPNLPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text3).addClass('PARA');
                          currentRow.append();

                          var jKiriPARASinyal = KiriPARASinyal+1;
                          localStorage.setItem("KiriPARASinyal",jKiriPARASinyal)
                          $("#lKiriPARASinyal").text(localStorage.getItem('KiriPARASinyal')); 
                          MultisendMessage(message);
                        }else{
                          var currentRow = $('#sellPARA'+dataInPARA.token).html(text1).addClass('PARA');
                          var currentRow = $('#sellPNLPARA'+dataInPARA.token).html(text3).addClass('PARA');
                          currentRow.append();
                        }
                   }



              //  console.log(`Cek data PARA berhasil!!`);
                },
                  error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                               var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    }else if (jqXHR.status === 429){
                         var alert1="KENA LIMIT";
                    }else {
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }

                    KiriPARAError = KiriPARAError+1;
                    localStorage.setItem("KiriPARAError",KiriPARAError)
                    $("#lKiriPARAError").text(localStorage.getItem('KiriPARAError'));

                    var currentRow = $('#sellPARA'+dataInPARA.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KiriPARAError')+"");
                    var currentRow = $('#sellPNLPARA'+dataInPARA.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#info123").css("color", "red");
                    $("#info123").text("KIRI : " + dataInPARA.token +" [FAILED]" );
                    console.error("Cek data PARA gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapDariPARA(dataInPARA){
          var jumlahR = Math.pow(10, dataInPARA.desTo)*dataInPARA.jumlahR;
          var jumlahR = BigInt(Math.round(Number(jumlahR)));
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          var KananPARASinyal = parseInt(localStorage.getItem('KananPARASinyal'));
          var ServerPARAKanan = dataInPARA.ServerPARAKanan;
         // var KananPARAError = parseInt(localStorage.getItem('KananPARAError'));
         
          var apiUrl =
                        "https://apiv5.PARAswap.io/prices/?"+
                        "destToken="+dataInPARA.scFrom+
                        "&destDecimals="+dataInPARA.desFrom+
                        "&srcToken="+dataInPARA.scTo+
                        "&srctDecimals="+dataInPARA.desTo+
                        "&side=SELL&network=56"+
                        "&amount=" +
                        jumlahR;

            console.log("PARA KANAN :" +apiUrl);
            // Panggil REST API
            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(resPARA) {

                $("#info223").css("color", "green");
                $("#info223").text("KANAN : " + dataInPARA.token +" [OK]" );

                var hargaPARA =(dataInPARA.modalR/dataInPARA.PriceRate)/(resPARA.priceRoute.destAmount/(Math.pow(10,dataInPARA.desFrom))/dataInPARA.PriceRate);
                var PNL =((dataInPARA.modalR/hargaPARA)*dataInPARA.bidPrice)-dataInPARA.modalR;   
                var FeeSwap = resPARA.priceRoute.gasCostUSD;

                var persen = ((dataInPARA.askPrice-hargaPARA)/dataInPARA.askPrice)*100;
                var totalFeeKanan = parseFloat(dataInPARA.modalR * 0.001) +parseFloat(FeeSwap);
                var netpnl = parseFloat(PNL-totalFeeKanan).toFixed(2);
              // if(PNL>10){
                //    console.log(`TOKEN ${dataInPARA.token}`);
                    console.log(`----- PARA KANAN : ${dataInPARA.token} --------`);
                    console.log(`BINANCE BUY : ${dataInPARA.askPrice} `);
                    console.log(`PARA SELL : ${hargaPARA} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`FEE WD : ${dataInPARA.feeWD} `);
                    console.log(`TOTAL FEE : ${totalFeeKanan} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`--------------------------------------`);

              //console.log("fee total:"+totalFeeKiri);
                     var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KANAN",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKanan.toFixed(2),
                            FeeSwap : parseFloat(FeeSwap).toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataInPARA.token,
                            scTo: dataInPARA.scFrom,
                            desTo: dataInPARA.desFrom,
                            scFrom: dataInPARA.scTo,
                            desFrom: dataInPARA.desTo,
                            sell : dataInPARA.askPrice,
                            buy : hargaPARA.toFixed(7),
                            modalR:DATA.MODALKANAN
                        };


               var text ="<a href=#buyPARA"+dataInPARA.token+"> PARA : </a> <a href='https://bscscan.com/token/" + dataOUT.scTo +"'>"+(dataInPARA.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataInPARA.token).replace("USDT", "")+"' target=_blank> [DP] </a><br/>";
               var sinyal =parseInt(localStorage.getItem('KananPARASinyal')+1);
               var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaPARA.toFixed(7)+"<br/> Fee:"+totalFeeKanan.toFixed(2)+"$";
               var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
               var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
               var text13 ="PARA : <a href=#buyPARA"+dataInPARA.token+">"+dataInPARA.token+"</a> PNL :"+PNL.toFixed(2)+"$ <br/>";

               var message =
                         "MULTISCAN-<b>"+localStorage.getItem('idserver')+":PARA#"+sinyal+"</b>"+" \n -----------------------------------------"+
                          " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scTo +"'>[ SC ]</a>"+
                          "  <a href='https://bscscan.com/token/"+dataOUT.scTo+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                         // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                          " \n MODAL : <b> "+ dataOUT.modalR + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                          " \n <b>BUY : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.buy +"</a>"+
                          " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.sell +"</a>"+
                          " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                          " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                          " \n -----------------------------------------";

                if($('#checkboxFilter').is(':checked')) {
                 
                      if (PNL > dataInPARA.innetPNL) {
                       
                        $('#sinyalkanan').append(text);
                          var currentRow = $('#buyPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text1).addClass('PARA');
                          var currentRow = $('#buyPNLPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text3).addClass('PARA');
                          currentRow.append();

                          var jKananPARASinyal = KananPARASinyal+1;
                          localStorage.setItem("KananPARASinyal",jKananPARASinyal)
                          $("#lKananPARASinyal").text(localStorage.getItem('KananPARASinyal'));
                          MultisendMessage(message);
                     }else{
                         var currentRow = $('#buyPARA'+dataInPARA.token).css({"text-align":"center"}).html(text1).addClass('PARA');
                         var currentRow = $('#buyPNLPARA'+dataInPARA.token).css({"text-align":"center"}).html(text3).addClass('PARA');
                         currentRow.append();
                        }
                  }else{
                    console.log("itu")
                        if (netpnl > totalFeeKanan){
                          $('#sinyalkanan').append(text);
                        
                          var currentRow = $('#buyPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text1).addClass('PARA');
                          var currentRow = $('#buyPNLPARA'+dataInPARA.token).css({"background-color":"green","color": "white"}).html(text3).addClass('PARA');
                          currentRow.append();

                          var jKananPARASinyal = KananPARASinyal+1;
                          localStorage.setItem("KananPARASinyal",jKananPARASinyal)
                          $("#lKananPARASinyal").text(localStorage.getItem('KananPARASinyal'));
                          MultisendMessage(message);
                        }else{
                          var currentRow = $('#buyPARA'+dataInPARA.token).html(text1).addClass('PARA');
                          var currentRow = $('#buyPNLPARA'+dataInPARA.token).html(text3).addClass('PARA');
                          currentRow.append();
                        }
                   }

              //  console.log(`Cek data PARA berhasil!!`);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                               var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    }else if (jqXHR.status === 429){
                                var alert1="KENA LIMIT";
                    } else {
                        // var alert1=jqXHR.statusText + "(" + jqXHR.status + ")";
                        var alert1="ERROR";
                    }
                    
                    KananPARAError = KananPARAError+1;
                    localStorage.setItem("KananPARAError",KananPARAError)
                    $("#lKananPARAError").text(localStorage.getItem('KananPARAError'));

                    var currentRow = $('#buyPARA'+dataInPARA.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KananPARAError')+"");
                    var currentRow = $('#buyPNLPARA'+dataInPARA.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#info223").css("color", "red");
                    $("#info223").text("KANAN : " + dataInPARA.token +" [FAILED]" );
                    console.error("Cek data PARA gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapKeKYBER(dataInKYBER){
          var jumlahL = Math.pow(10, dataInKYBER.desFrom)*dataInKYBER.jumlahL;
          var jumlahL = BigInt(Math.round(Number(jumlahL)));
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');
          var KiriKYBERSinyal = parseInt(localStorage.getItem('KiriKYBERSinyal'));
          var ServerKYBERKiri = dataInKYBER.ServerKYBERKiri;
         
          var apiUrl =
                        "https://aggregator-api.kyberswap.com/bsc/api/v1/routes?"+
                        "tokenIn="+dataInKYBER.scFrom+
                        "&tokenOut="+dataInKYBER.scTo+
                        "&amountIn=" +
                        jumlahL;

           // console.log("KYBER URL:" +apiUrl);
            // Panggil REST API
            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(resKYBER) {

                $("#info123").css("color", "green");
                $("#info123").text("KIRI : " + dataInKYBER.token +" [OK]" );
                var PNL = ((resKYBER.data.routeSummary.amountOut/Math.pow(10,dataInKYBER.desTo))*dataInKYBER.PriceRate)-dataInKYBER.modalL;
                var hargaKYBER =(Number(dataInKYBER.modalL) + PNL)/(dataInKYBER.modalL/dataInKYBER.askPrice);
                var persen = ((hargaKYBER - dataInKYBER.askPrice)/dataInKYBER.askPrice)*100;

                var FeeSwap = resKYBER.data.routeSummary.gasUsd;
                var totalFeeKiri = parseFloat(dataInKYBER.modalL * 0.001) +parseFloat(dataInKYBER.feeWD)+parseFloat(FeeSwap);
                var netpnl = parseFloat(PNL-totalFeeKiri).toFixed(2);
              // if(PNL>10){
                // total fee = 0.04+0.4 + 0.1 = 0.45 --> netpnl = pnl-totalfee
                //    console.log(`TOKEN ${dataInKYBER.token}`);
                    console.log(`----- KYBER KIRI : ${dataInKYBER.token} --------`);
                    console.log(`BINANCE BUY : ${dataInKYBER.askPrice} `);
                    console.log(`KYBER SELL : ${hargaKYBER} `);
                    console.log(`PNL : ${PNL} `);
                    console.log(`FEE SWAP : ${FeeSwap} `);
                    console.log(`FEE WD : ${dataInKYBER.feeWD} `);
                    console.log(`TOTAL FEE : ${totalFeeKiri} `);
                    console.log(`NET PNL : ${netpnl} `);
                    console.log(`Prosentase : ${persen} `);
                    console.log(`--------------------------------------`);

              //console.log("fee total:"+totalFeeKiri);
                     var dataOUT = {
                            idserver: localStorage.getItem('idserver'),
                            market : "KIRI",
                            PNL : PNL.toFixed(2),
                            netPNL : netpnl,
                            totalfee : totalFeeKiri.toFixed(2),
                            FeeSwap : parseFloat(FeeSwap).toFixed(2),
                            persen : persen.toFixed(2),
                            pair: dataInKYBER.token,
                            scFrom: dataInKYBER.scFrom,
                            desFrom: dataInKYBER.desFrom,
                            scTo: dataInKYBER.scTo,
                            desTo: dataInKYBER.desTo,
                            buy : dataInKYBER.askPrice,
                            sell: hargaKYBER.toFixed(7),
                            modalL:DATA.MODALKIRI
                        };

                        var text ="<a href=#sellKYBER"+dataInKYBER.token+">KYBER : </a>  <a href='https://bscscan.com/token/" + dataOUT.scFrom +"' target=_blank>"+(dataInKYBER.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/withdrawal/crypto/"+(dataInKYBER.token).replace("USDT", "")+"' target=_blank> [WD] </a><br/>";
                        var sinyal =parseInt(localStorage.getItem('KiriKYBERSinyal'))+1;
                        var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaKYBER.toFixed(7)+" </a> <br/> Fee:"+totalFeeKiri.toFixed(2)+"$";
                        var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";                        
                        var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                        var text13 ="KYBER : <a href=#sellKYBER"+dataInKYBER.token+">"+dataInKYBER.token+" </a> PNL:"+PNL.toFixed(2)+"$ <br/>";

                        var message =
                       "MULTISCAN-<b>"+localStorage.getItem('idserver')+":KYBER#"+sinyal+"</b>"+" \n -----------------------------------------"+
                        " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scFrom +"'>[ SC ]</a>"+
                        " <a href='https://bscscan.com/token/"+dataOUT.scFrom+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                       // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                        " \n MODAL : <b> "+ dataOUT.modalL + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                        " \n <b>BUY : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.buy +"</a>"+
                        " \n <b>SELL : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.sell+"</a>"+
                        " \n FEE WD : <b>" + parseFloat(dataInKYBER.feeWD) +"$</b>"+
                        " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                        " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                        " \n -----------------------------------------";

                if($('#checkboxFilter').is(':checked')) {
                      if (PNL > dataInKYBER.innetPNL) {
                       
                        $('#sinyalkiri').append(text);
                          var currentRow = $('#sellKYBER'+dataInKYBER.token).html(text1).css({"background-color":"green","color": "white"}).addClass('KYBER');
                          var currentRow = $('#sellPNLKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text3).addClass('KYBER');
                          currentRow.append();

                          var jKiriKYBERSinyal = KiriKYBERSinyal+1;
                          localStorage.setItem("KiriKYBERSinyal",jKiriKYBERSinyal)
                          $("#lKiriKYBERSinyal").text(localStorage.getItem('KiriKYBERSinyal')); 
                          MultisendMessage(message);
                     }else{
                         var currentRow = $('#sellKYBER'+dataInKYBER.token).css({"text-align":"center"}).html(text1).addClass('KYBER');
                         var currentRow = $('#sellPNLKYBER'+dataInKYBER.token).css({"text-align":"center"}).html(text3).addClass('KYBER');
                         currentRow.append();
                      }
                      
                  }else{
                        if (netpnl > totalFeeKiri){
                         
                          $('#sinyalkiri').append(text);
                          var currentRow = $('#sellKYBER'+dataInKYBER.token).html(text1).css({"background-color":"green","color": "white"}).addClass('KYBER');
                          var currentRow = $('#sellPNLKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text3).addClass('KYBER');
                          currentRow.append();

                          var jKiriKYBERSinyal = KiriKYBERSinyal+1;
                          localStorage.setItem("KiriKYBERSinyal",jKiriKYBERSinyal)
                          $("#lKiriKYBERSinyal").text(localStorage.getItem('KiriKYBERSinyal')); 
                          MultisendMessage(message);
                        }else{
                          var currentRow = $('#sellKYBER'+dataInKYBER.token).html(text1).addClass('KYBER');
                          var currentRow = $('#sellPNLKYBER'+dataInKYBER.token).html(text3).addClass('KYBER');
                          currentRow.append();
                        }
                   }



              //  console.log(`Cek data KYBER berhasil!!`);
                },
                 /* error: function(jqXHR, textStatus, errorThrown) {
                  if (jqXHR.status === 400) {
                        // Parse respons JSON
                        try {
                            var errorResponse = JSON.parse(jqXHR.responseText);
                            // Cek jika properti 'description' ada dalam respons JSON
                            if (errorResponse && errorResponse.description) {
                                var errorMessage = errorResponse.description;
                               var alert1=errorMessage;
                            } else {
                               var alert1='Error ' + jqXHR.status + ': Bad Request';
                            }
                        } catch (e) {
                            var alert1='Error ' + jqXHR.status + ': Bad Request';
                        }
                    }else if (jqXHR.status === 429){
                         var alert1="KENA LIMIT";
                    }else {
                        var alert1= "(" + jqXHR.status + ")";
                    }
                    */
                    error: function(jqXHR, textStatus, errorThrown) {
                    if (jqXHR.status == 429) {
                      var alert1 = "limit rate";
                    } else {
                      // Show a general error message for other statuses
                      // var errorMessage = "KENA LIMIT";
                      // var alert1 = errorMessage;
                      var alert1="KENA LIMIT";
                    }
                    

                    KiriKYBERError = KiriKYBERError+1;
                    localStorage.setItem("KiriKYBERError",KiriKYBERError)
                    $("#lKiriKYBERError").text(localStorage.getItem('KiriKYBERError'));

                    var currentRow = $('#sellKYBER'+dataInKYBER.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KiriKYBERError')+"");
                    var currentRow = $('#sellPNLKYBER'+dataInKYBER.token).css({"background-color":"white","color": "red"}).html(alert1);
                    currentRow.append();

                    $("#info123").css("color", "red");
                    $("#info123").text("KIRI : " + dataInKYBER.token +"[" +alert1+"]" );
                    console.error("Cek data KYBER gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                },timeout: 12000
            });
        }

        function swapDariKYBER(dataInKYBER){
            var jumlahR = Math.pow(10, dataInKYBER.desTo)*dataInKYBER.jumlahR;
            var jumlahR = BigInt(Math.round(Number(jumlahR)));
            var gasGWEI = localStorage.getItem('gasGWEI');
            var PriceBNB = localStorage.getItem('PriceBNB');
            var KananKYBERSinyal = parseInt(localStorage.getItem('KananKYBERSinyal'));
            var ServerKYBERKanan = dataInKYBER.ServerKYBERKanan;
            var apiUrl =
                          "https://aggregator-api.kyberswap.com/bsc/api/v1/routes?"+
                          "tokenOut="+dataInKYBER.scFrom+
                          "&tokenIn="+dataInKYBER.scTo+
                          "&amountIn=" +
                          jumlahR;

             // console.log("KYBER KANAN :" +apiUrl);
              // Panggil REST API
              $.ajax({
                  url: apiUrl,
                  method: 'GET',
                  success: function(resKYBER) {

                  $("#info223").css("color", "green");
                  $("#info223").text("KANAN : " + dataInKYBER.token +" [OK]" );

                  var hargaKYBER =(dataInKYBER.modalR/dataInKYBER.PriceRate)/(resKYBER.data.routeSummary.amountOut/(Math.pow(10,dataInKYBER.desFrom))/dataInKYBER.PriceRate);
                  var PNL =((dataInKYBER.modalR/hargaKYBER)*dataInKYBER.bidPrice)-dataInKYBER.modalR;   
                  var FeeSwap =  resKYBER.data.routeSummary.gasUsd;

                  var persen = ((dataInKYBER.askPrice-hargaKYBER)/dataInKYBER.askPrice)*100;
                  var totalFeeKanan = parseFloat(dataInKYBER.modalR * 0.001) +parseFloat(FeeSwap);
                  var netpnl = parseFloat(PNL-totalFeeKanan).toFixed(2);
                // if(PNL>10){
                  //    console.log(`TOKEN ${dataInKYBER.token}`);
                      console.log(`----- KYBER KANAN : ${dataInKYBER.token} --------`);
                      console.log(`BINANCE BUY : ${dataInKYBER.askPrice} `);
                      console.log(`KYBER SELL : ${hargaKYBER} `);
                      console.log(`PNL : ${PNL} `);
                      console.log(`FEE SWAP : ${FeeSwap} `);
                      console.log(`FEE WD : ${dataInKYBER.feeWD} `);
                      console.log(`TOTAL FEE : ${totalFeeKanan} `);
                      console.log(`NET PNL : ${netpnl} `);
                      console.log(`Prosentase : ${persen} `);
                      console.log(`--------------------------------------`);

                //console.log("fee total:"+totalFeeKiri);
                      var dataOUT = {
                              idserver: localStorage.getItem('idserver'),
                              market : "KANAN",
                              PNL : PNL.toFixed(2),
                              netPNL : netpnl,
                              totalfee : totalFeeKanan.toFixed(2),
                              FeeSwap : parseFloat(FeeSwap).toFixed(2),
                              persen : persen.toFixed(2),
                              pair: dataInKYBER.token,
                              scTo: dataInKYBER.scFrom,
                              desTo: dataInKYBER.desFrom,
                              scFrom: dataInKYBER.scTo,
                              desFrom: dataInKYBER.desTo,
                              sell : dataInKYBER.askPrice,
                              buy : hargaKYBER.toFixed(7),
                              modalR:DATA.MODALKANAN
                          };


                var text ="<a href=#buyKYBER"+dataInKYBER.token+">KYBER : </a>  <a href='https://bscscan.com/token/" + dataOUT.scTo +"' target=_blank>"+(dataInKYBER.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataInKYBER.token).replace("USDT", "")+"' target=_blank> [DP] </a> <br/>";
                var sinyal =parseInt(localStorage.getItem('KananKYBERSinyal')+1);
                var text1 ="<a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"' target=_blank>"+hargaKYBER.toFixed(7)+"<br/> Fee:"+totalFeeKanan.toFixed(2)+"$";
                var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                var text13 ="KYBER : <a href=#buyKYBER"+dataInKYBER.token+">"+dataInKYBER.token+"</a> PNL :"+PNL.toFixed(2)+"$ <br/>";

                var message =
                           "MULTISCAN-<b>"+localStorage.getItem('idserver')+":KYBER#"+sinyal+"</b>"+" \n -----------------------------------------"+
                            " \n "+dataOUT.market+" : <b>#" + dataOUT.pair +"</b> <a href='https://bscscan.com/address/" + dataOUT.scTo +"'>[ SC ]</a>"+
                            "  <a href='https://bscscan.com/token/"+dataOUT.scTo+"?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>"+
                           // " \n NET OPIT : "+dataOUT.netPNL+"$ (<b>"+ dataOUT.persen +" %</b>)"+
                            " \n MODAL : <b> "+ dataOUT.modalR + "</b> | PNL : <b>"+ dataOUT.PNL + "$ </b> "+
                            " \n <b>BUY : </b> <a href='https://swap.defillama.com/?chain=bsc&from="+dataOUT.scFrom+"&to="+dataOUT.scTo +"'>" +dataOUT.buy +"</a>"+
                            " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" +dataOUT.pair +"?from=markets%26theme=light%26type=spot'>" + dataOUT.sell +"</a>"+
                            " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap +"$</b>"+
                            " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee +"$</b>"+
                            " \n -----------------------------------------";

                  if($('#checkboxFilter').is(':checked')) {
                  
                        if (PNL > dataInKYBER.innetPNL) {
                        
                          $('#sinyalkanan').append(text);
                            var currentRow = $('#buyKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text1).addClass('KYBER');
                            var currentRow = $('#buyPNLKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text3).addClass('KYBER');
                            currentRow.append();

                            var jKananKYBERSinyal = KananKYBERSinyal+1;
                            localStorage.setItem("KananKYBERSinyal",jKananKYBERSinyal)
                            $("#lKananKYBERSinyal").text(localStorage.getItem('KananKYBERSinyal'));
                            MultisendMessage(message);
                      }else{
                          var currentRow = $('#buyKYBER'+dataInKYBER.token).css({"text-align":"center"}).html(text1).addClass('KYBER');
                          var currentRow = $('#buyPNLKYBER'+dataInKYBER.token).css({"text-align":"center"}).html(text3).addClass('KYBER');
                          currentRow.append();
                          }
                    }else{
                      console.log("itu")
                          if (netpnl > totalFeeKanan){
                            $('#sinyalkanan').append(text);
                          
                            var currentRow = $('#buyKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text1).addClass('KYBER');
                            var currentRow = $('#buyPNLKYBER'+dataInKYBER.token).css({"background-color":"green","color": "white"}).html(text3).addClass('KYBER');
                            currentRow.append();

                            var jKananKYBERSinyal = KananKYBERSinyal+1;
                            localStorage.setItem("KananKYBERSinyal",jKananKYBERSinyal)
                            $("#lKananKYBERSinyal").text(localStorage.getItem('KananKYBERSinyal'));
                            MultisendMessage(message);
                          }else{
                            var currentRow = $('#buyKYBER'+dataInKYBER.token).html(text1).addClass('KYBER');
                            var currentRow = $('#buyPNLKYBER'+dataInKYBER.token).html(text3).addClass('KYBER');
                            currentRow.append();
                          }
                    }

                //  console.log(`Cek data KYBER berhasil!!`);
                  },
                 /* error: function(jqXHR, textStatus, errorThrown) {
                    if (jqXHR.status === 400) {
                          // Parse respons JSON
                          try {
                              var errorResponse = JSON.parse(jqXHR.responseText);
                              // Cek jika properti 'description' ada dalam respons JSON
                              if (errorResponse && errorResponse.description) {
                                  var errorMessage = errorResponse.description;
                                var alert1=errorMessage;
                              } else {
                                var alert1='Error ' + jqXHR.status + ': Bad Request';
                              }
                          } catch (e) {
                              var alert1='Error ' + jqXHR.status + ': Bad Request';
                          }
                      }else if (jqXHR.status === 429){
                                  var alert1="KENA LIMIT";
                      } else {
                          var alert1= "(" + jqXHR.status + ")";
                      }
                      */
                      error: function(jqXHR, textStatus, errorThrown) {
                        if (jqXHR.status == 429) {
                          var alert1 = "limit rate";
                        } else {
                          // Show a general error message for other statuses
                          // var errorMessage = "KENA LIMIT";
                          // var alert1 = errorMessage;
                          var alert1="KENA LIMIT";
                        }

                      KananKYBERError = KananKYBERError+1;
                      localStorage.setItem("KananKYBERError",KananKYBERError)
                      $("#lKananKYBERError").text(localStorage.getItem('KananKYBERError'));

                      var currentRow = $('#buyKYBER'+dataInKYBER.token).css({"background-color":"white","color": "red"}).text(localStorage.getItem('KananKYBERError')+"");
                      var currentRow = $('#buyPNLKYBER'+dataInKYBER.token).css({"background-color":"white","color": "red"}).html(alert1);
                      currentRow.append();

                      $("#info223").css("color", "red");
                      $("#info223").text("KANAN : " + dataInKYBER.token +"[" +alert1+"]" );
                      console.error("Cek data KYBER gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
                  },timeout: 12000
              });
          }

        function swapKeODOS(dataInODOS) {
          var KiriODOSSinyal = parseInt(localStorage.getItem("KiriODOSSinyal"));
          var jumlahL = Math.pow(10, dataInODOS.desFrom) * dataInODOS.jumlahL;
          var jumlahL = BigInt(Math.round(Number(jumlahL)));
          var gasGWEI = localStorage.getItem('gasGWEI');
          var PriceBNB = localStorage.getItem('PriceBNB');

          var apiUrl =  "https://api.odos.xyz/sor/quote/v2";
          // console.log("ODOS URL KIRI :" +apiUrl);

          var requestData = {
            chainId: 56,
            inputTokens: [
              {
                amount: jumlahL.toString(),
                tokenAddress: dataInODOS.scFrom,
              },
            ],
            outputTokens: [
              {
                proportion: 1,
                tokenAddress: dataInODOS.scTo,
              },
            ],

            // sourceWhitelist: ["Bancor V2", "Bancor V3"],

             "sourceBlacklist":[
                "Acsi Finance Weighted",
            //         "Convex FXS Depositor",
            //         "Curve Crypto Factory",
            //         "Curve Crypto Registry",
            //         "Curve Factory",
            //         "Curve Registry",
                 ],
            referralCode: 0,
            slippageLimitPercent: 0.4,
          };
          // console.log("RE DATA :" +requestData);

          $.ajax({
            url: apiUrl,
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            data: JSON.stringify(requestData),
            success: function (resODOS) {
              $("#info5").css("color", "green");
              $("#info5").text(
                "STATUS ODOS KIRI: " + dataInODOS.token + " [OK]"
              );

              var PNL = Number(resODOS.outValues - dataInODOS.modalL);
              var FeeSwap = resODOS.gasEstimateValue;
              var hargaODOS =
                (Number(dataInODOS.modalL) + PNL) /
                (dataInODOS.modalL / dataInODOS.askPrice);
              var persen =
                ((hargaODOS - dataInODOS.askPrice) / dataInODOS.askPrice) * 100;
              var totalFeeKiri =
                parseFloat(dataInODOS.modalL * 0.001) +
                parseFloat(dataInODOS.feeWD) +
                parseFloat(resODOS.gasEstimateValue);
              var netpnl = parseFloat(PNL - totalFeeKiri).toFixed(2);

              // console.log(`----- ODOS KIRI : ${dataInODOS.token} --------`);
              // console.log(`MODAL : ${dataInODOS.modalL} `);
              // console.log(`BINANCE BUY : ${dataInODOS.askPrice} `);
              // console.log(`JUMLAH BNT : ${JMLBNTKiri} `);
              // console.log(` BNT BELI : ${localStorage.getItem("BNTBUY")} `);
              // console.log(` BNT JUAL: ${localStorage.getItem("BNTSELL")} `);
              // console.log(`ODOS SELL : ${hargaODOS} `);
              // console.log(`FEE WD : ${dataInODOS.feeWD} `);
              // console.log(`FEE SWAP : ${resODOS.gasEstimateValue} `);
              // console.log(
              //   `TOTAL FEE : ${parseFloat(
              //     dataInODOS.feeWD + resODOS.gasEstimateValue
              //   )} `
              // );
              // console.log(`NET PNL : ${netpnl} `);
              // console.log(`PNL BNT : ${PNL} `);
              // console.log(`INET PNL : ${dataInODOS.innetPNL} `);
              // console.log(`Prosentase : ${persen} `);
              // console.log(`--------------------------------------`);

                console.log(`----- ODOS KIRI : ${dataInODOS.token} --------`);
                console.log(`BINANCE BUY : ${dataInODOS.askPrice} `);
                console.log(`ODOS SELL : ${hargaODOS} `);
                console.log(`PNL : ${PNL} `);
                console.log(`FEE SWAP : ${resODOS.gasEstimateValue} `);
                console.log(`FEE WD : ${dataInODOS.feeWD} `);
                console.log(`TOTAL FEE : ${parseFloat(
                  dataInODOS.feeWD + resODOS.gasEstimateValue
                )} `);
                console.log(`NET PNL : ${netpnl} `);
                console.log(`Prosentase : ${persen} `);
                console.log(`--------------------------------------`);

              var dataOUT = {
                idserver: localStorage.getItem("idserver"),
                market: "KIRI",
                PNL: PNL.toFixed(2),
                FeeSwap : parseFloat(FeeSwap).toFixed(2),
                netPNL: netpnl,
                totalfee: totalFeeKiri.toFixed(2),
                persen: persen.toFixed(2),
                pair: dataInODOS.token,
                scFrom: dataInODOS.scFrom,
                desFrom: dataInODOS.desFrom,
                scTo: dataInODOS.scTo,
                desTo: dataInODOS.desTo,
                buy: dataInODOS.askPrice,
                sell: hargaODOS.toFixed(7),
                modalL: DATA.MODALKIRI,
              };

              var text ="<a href=#buyODOS"+dataInODOS.token+">ODOS : </a>  <a href='https://bscscan.com/token/" + dataOUT.scTo +"' target=_blank>"+(dataInODOS.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataInODOS.token).replace("USDT", "")+"' target=_blank> [WD] </a> <br/>";
                var sinyal =parseInt(localStorage.getItem('KiriODOSSinyal')+1);
                var text1 ="<a href='https://app.odos.xyz/' target=_blank>"+hargaODOS.toFixed(7)+"</a><br/> Fee:"+totalFeeKiri.toFixed(2)+"$";
                var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                var text13 ="ODOS : <a href=#buyODOS"+dataInODOS.token+">"+dataInODOS.token+"</a> PNL :"+PNL.toFixed(2)+"$ <br/>";

                var message =
                      "MULTISCAN-<b>"+localStorage.getItem('idserver')+ ":ODOS#" + sinyal + "</b>" +
                        " \n -----------------------------------------" +
                        " \n " + dataOUT.market + " : <b>#" + dataOUT.pair + "</b> <a href='https://bscscan.com/address/" + dataOUT.scTo + "'>[ SC ]</a>" +
                        "  <a href='https://bscscan.com/token/" + dataOUT.scTo + "?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>" +
                        " \n MODAL : <b> " + dataOUT.modalL + "</b> | PNL : <b>" + dataOUT.PNL + "$ </b> " +
                        " \n <b>BUY : </b> <a href='https://app.odos.xyz/' target='_blank'>" + dataOUT.buy + "</a>" +
                        " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" + dataOUT.pair + "?from=markets%26theme=light%26type=spot'>" + dataOUT.sell + "</a>" +
                        " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap + "$</b>" +
                        " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee + "$</b>" +
                        " \n -----------------------------------------";

              if (PNL > parseFloat(dataInODOS.innetPNL)) {
                // alert (PNL+""+dataInODOS.innetPNL);
                $("#sinyalkiri").append(text);
                // var currentRow = $('#BNTto'+dataInODOS.token).html(textVolBNT);
                //var currentRow = $('#BNTPNLto'+dataInODOS.token).html(textBNTUSDT);
                var currentRow = $("#sellODOS" + dataInODOS.token)
                  .css({ "background-color": "green", color: "white" })
                  .html(text1)
                  .addClass("ODOS");
                var currentRow = $("#sellPNLODOS" + dataInODOS.token)
                  .css({ "background-color": "green", color: "white" })
                  .html(text3)
                  .addClass("ODOS");
                currentRow.append();

                var jKiriODOSSinyal = KiriODOSSinyal + 1;
                localStorage.setItem("KiriODOSSinyal", jKiriODOSSinyal);
                $("#lKiriODOSSinyal").text(
                  localStorage.getItem("KiriODOSSinyal")
                );
                MultisendMessage(message);
              } else {
                var currentRow = $("#sellODOS" + dataInODOS.token)
                  .css({ "text-align": "center" })
                  .html(text1)
                  .addClass("ODOS");
                var currentRow = $("#sellPNLODOS" + dataInODOS.token)
                  .css({ "text-align": "center" })
                  .html(text3)
                  .addClass("ODOS");
                currentRow.append();
              }
            },
            error: function (jqXHR, textStatus, errorThrown) {
              if (jqXHR.status == 400) {
                // Parse respons JSON
                
                  var errorResponse = JSON.parse(jqXHR.responseText);
                  // Cek jika properti 'description' ada dalam respons JSON
                  if (errorResponse && errorResponse.detail=="No viable path found") {
                    // var errorMessage = errorResponse.detail;
                    var alert1 = "NO LP";
                  } else {
                    var alert1 = "NO LISTING";
                  }
                
                  // var alert1 = "Error " + jqXHR.status + ": Bad Request";
                
              }else if (jqXHR.status == 429) {
                var alert1 = "KENA LIMIT";
              }else if (jqXHR.status == 200) {
                var alert1 = " NO PRICE";
              }
               else {
                // var alert1 = jqXHR.statusText + "(" + jqXHR.status + ")";
                var alert1="ERROR";
              }

              KiriODOSError = KiriODOSError + 1;
              localStorage.setItem("KiriODOSError", KiriODOSError);
              $("#lKiriODOSError").text(localStorage.getItem("KiriODOSError"));

              var currentRow = $("#sellODOS" + dataInODOS.token)
                .css({ "background-color": "white", color: "red" })
                .text(localStorage.getItem("KiriODOSError"));
              var currentRow = $("#sellPNLODOS" + dataInODOS.token)
                .css({ "background-color": "white", color: "red" })
                .html(alert1);
              currentRow.append();

              $("#info123").css("color", "red");
              $("#info123").text("KIRI : " + dataInODOS.token + " [FAILED]");
              console.error("Cek data ODOS gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
            },timeout: 12000
          });
        }

        function swapDariODOS(dataInODOS) {
          var KananODOSSinyal = parseInt(
            localStorage.getItem("KananODOSSinyal")
          );
          var jumlahR = Math.pow(10, dataInODOS.desTo) * dataInODOS.jumlahR;
          var jumlahR = BigInt(Math.round(Number(jumlahR)));

          var apiUrl =  "https://api.odos.xyz/sor/quote/v2";
          // console.log("ODOS URL KIRI :" +apiUrl);

          var requestData = {
            chainId: 56,
            inputTokens: [
              {
                amount: jumlahR.toString(),
                tokenAddress: dataInODOS.scTo,
              },
            ],
            outputTokens: [
              {
                proportion: 1,
                tokenAddress: dataInODOS.scFrom,
              },
            ],

            // sourceWhitelist: ["Bancor V2", "Bancor V3"],

             "sourceBlacklist":[
                "Acsi Finance Weighted",
            //     "Convex FXS Depositor",
            //     "Curve Crypto Factory",
            //     "Curve Crypto Registry",
            //     "Curve Factory",
            //     "Curve Registry",
            ],
            referralCode: 0,
            slippageLimitPercent: 0.4,
          };

          // console.log("RE DATA :" +requestData);

          $.ajax({
            url: apiUrl,
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            data: JSON.stringify(requestData),
            success: function (resODOS) {
              $("#info5").css("color", "green");
              $("#info5").text(
                "STATUS ODOS KANAN: " + dataInODOS.token + " [OK]"
              );
              var JMLKoinKanan = parseFloat(
                resODOS.outAmounts / Math.pow(10, dataInODOS.desFrom)
              ).toFixed(2);
              var PNLKoin = parseFloat(
                dataInODOS.bidPrice * JMLKoinKanan - dataInODOS.modalR
              ).toFixed(2);

              var hargaODOS =
                dataInODOS.modalR /
                dataInODOS.PriceRate /
                (resODOS.outAmounts /
                  Math.pow(10, dataInODOS.desFrom) /
                  dataInODOS.PriceRate);
              var PNL =
                (dataInODOS.modalR / hargaODOS) * dataInODOS.bidPrice -
                dataInODOS.modalR;
              var persen =
                ((dataInODOS.bidPrice - hargaODOS) / dataInODOS.bidPrice) * 100;

              var FeeSwap = resODOS.gasEstimateValue;
              var totalFeeKanan =
                parseFloat(dataInODOS.modalR * 0.001) +
                parseFloat(FeeSwap) +
                parseFloat(localStorage.getItem("USDTGasBNB") * 0.5);
              var netpnl = parseFloat(PNL - totalFeeKanan).toFixed(2);

              console.log(`----- ODOS KANAN : ${dataInODOS.token} --------`);
              console.log(`MODAL : ${dataInODOS.modalR} `);
              console.log(`MODAL ETH : ${dataInODOS.jumlahR} `);
              console.log(`BINANCE SELL : ${dataInODOS.bidPrice} `);
              console.log(
                `JUMLAH BNT : ${dataInODOS.modalR / dataInODOS.bidPrice} `
              );
              console.log(`JUMLAH KOIN : ${JMLKoinKanan} `);
              console.log(`ODOS BUY : ${hargaODOS} `);
              console.log(`FEE SWAP : ${resODOS.gasEstimateValue} `);
              console.log(`TOTAL FEE : ${totalFeeKanan} `);
              console.log(`NET PNL : ${netpnl} `);
              console.log(`Prosentase : ${persen} `);
              console.log(`--------------------------------------`);

              var dataOUT = {
                idserver: localStorage.getItem("idserver"),
                market: "KANAN",
                PNL: PNL.toFixed(2),
                FeeSwap : parseFloat(FeeSwap).toFixed(2),
                netPNL: netpnl,
                totalfee: totalFeeKanan.toFixed(2),
                persen: persen.toFixed(2),
                pair: dataInODOS.token,
                scTo: dataInODOS.scFrom,
                desFrom: dataInODOS.desFrom,
                scFrom: dataInODOS.scTo,
                desTo: dataInODOS.desTo,
                sell: dataInODOS.bidPrice,
                buy: hargaODOS.toFixed(7),
                modalR: DATA.MODALKANAN,
              };

              var text ="<a href=#buyODOS"+dataInODOS.token+">ODOS : </a>  <a href='https://bscscan.com/token/" + dataOUT.scTo +"' target=_blank>"+(dataInODOS.token).replace("USDT", "")+"</a> PNL:"+PNL.toFixed(2)+"$ <a href='https://www.binance.me/en/my/wallet/account/main/deposit/crypto/"+(dataInODOS.token).replace("USDT", "")+"' target=_blank> [DP] </a> <br/>";
                var sinyal =parseInt(localStorage.getItem('KananODOSSinyal')+1);
                var text1 ="<a href='https://app.odos.xyz/' target=_blank>"+hargaODOS.toFixed(7)+"</a>"+"<br/> Fee:"+totalFeeKanan.toFixed(2)+"$";
                var text2 =""+netpnl+"$<br/>"+persen.toFixed(2)+"%";
                var text3 =""+PNL.toFixed(2)+"$<br/>"+persen.toFixed(2)+"%";
                var text13 ="ODOS : <a href=#buyODOS"+dataInODOS.token+">"+dataInODOS.token+"</a> PNL :"+PNL.toFixed(2)+"$ <br/>";

                var message =
                  "MULTISCAN-<b>"+localStorage.getItem('idserver')+ ":ODOS#" + sinyal + "</b>" +
                    " \n -----------------------------------------" +
                    " \n " + dataOUT.market + " : <b>#" + dataOUT.pair + "</b> <a href='https://bscscan.com/address/" + dataOUT.scTo + "'>[ SC ]</a>" +
                    "  <a href='https://bscscan.com/token/" + dataOUT.scTo + "?a=0x8894e0a0c962cb723c1976a4421c95949be2d4e3'>[ STOK ]</a>" +
                    " \n MODAL : <b> " + dataOUT.modalR + "</b> | PNL : <b>" + dataOUT.PNL + "$ </b> " +
                    " \n <b>BUY : </b> <a href='https://app.odos.xyz/' target='_blank'>" + dataOUT.buy + "</a>" +
                    " \n <b>SELL : </b><a href='https://www.binance.me/en/trade/" + dataOUT.pair + "?from=markets%26theme=light%26type=spot'>" + dataOUT.sell + "</a>" +
                    " \n ESTIMASI FEE SWAP : <b>" + dataOUT.FeeSwap + "$</b>" +
                    " \n ESTIMASI TOTAL FEE : <b>" + dataOUT.totalfee + "$</b>" +
                    " \n -----------------------------------------";

          
              if (PNL > parseFloat(dataInODOS.innetPNL)) {
                $("#sinyalkanan").append(text);
                var currentRow = $("#buyODOS" + dataInODOS.token)
                  .css({ "background-color": "green", color: "white" })
                  .html(text1)
                  .addClass("ODOS");
                var currentRow = $("#buyPNLODOS" + dataInODOS.token)
                  .css({ "background-color": "green", color: "white" })
                  .html(text3)
                  .addClass("ODOS");
                currentRow.append();

                var jKananODOSSinyal = KananODOSSinyal + 1;
                localStorage.setItem("KananODOSSinyal", jKananODOSSinyal);
                $("#lKananODOSSinyal").text(
                  localStorage.getItem("KananODOSSinyal")
                );

                MultisendMessage(message);
              } else {
                var currentRow = $("#buyODOS" + dataInODOS.token)
                  .css({ "text-align": "center" })
                  .html(text1)
                  .addClass("ODOS");
                var currentRow = $("#buyPNLODOS" + dataInODOS.token)
                  .css({ "text-align": "center" })
                  .html(text3)
                  .addClass("ODOS");
                currentRow.append();
              }
            
              //  console.log(`Cek data ODOS berhasil!!`);
            },
            error: function (jqXHR, textStatus, errorThrown) {
              if (jqXHR.status == 400) {
                // Parse respons JSON
                
                  var errorResponse = JSON.parse(jqXHR.responseText);
                  // Cek jika properti 'description' ada dalam respons JSON
                  if (errorResponse && errorResponse.detail=="No viable path found") {
                    // var errorMessage = errorResponse.detail;
                    var alert1 = "NO LP";
                  } else {
                    var alert1 = "NO LISTING";
                  }
                
                  // var alert1 = "Error " + jqXHR.status + ": Bad Request";
                
              }else if (jqXHR.status == 429) {
                var alert1 = "KENA LIMIT";
              }else if (jqXHR.status == 200) {
                var alert1 = "NO PRICE";
              } else {
                // var alert1 = jqXHR.statusText + "(" + jqXHR.status + ")";
                var alert1="ERROR";
              }

              KananODOSError = KananODOSError + 1;
              localStorage.setItem("KananODOSError", KananODOSError);
              $("#lKananODOSError").text(
                localStorage.getItem("KananODOSError")
              );

              var currentRow = $("#buyODOS" + dataInODOS.token)
                .css({ "background-color": "white", color: "red" })
                .text(localStorage.getItem("KananODOSError"));
              var currentRow = $("#buyPNLODOS" + dataInODOS.token)
                .css({ "background-color": "white", color: "red" })
                .html(alert1);
              currentRow.append();

              $("#info223").css("color", "red");
              $("#info223").text("KANAN : " + dataInODOS.token + " [FAILED]");
              console.error("Cek data ODOS gagal: " + alert1); // Tampilkan pesan kesalahan jika terjadi
            },timeout: 12000
          });
        }
   
        function updateProgress(totalscanned,tokenpair){
        //  totalscanned++;
          var coinData = DATA.LIST_TOKEN;
          var countTrueStatus = 0;

          $.each(coinData, function(index, coin) {
            if (coin.status === true) {
              countTrueStatus++;
            }
          });

          var perulangan = totalscanned / countTrueStatus;
          $('#scanprogress').html('Checking - [ '+ totalscanned + ' dari ' + countTrueStatus + ' token ]').css("color", "blue");
          $('#bar').css('width', (totalscanned / countTrueStatus * 100) + '%');
          if(totalscanned == countTrueStatus ){
            var mulai = parseInt(localStorage.getItem('startTime'));
            var endTime = new Date().getTime(); // Waktu akhir setelah panggilan REST API berhasil
          //  alert ("mulai "+mulai);
            var duration = (endTime - mulai)/1000; // Durasi panggilan API dalam milidetik
            localStorage.setItem("duration",duration);
          //  alert ("selisih "+duration);
            $("#hasil").text(localStorage.getItem('SERVERDEX')+ " :: HASIL SCANNING | DURASI : "+duration+" detik");  

            console.log('Panggilan REST API selesai dalam ' + duration + ' milidetik');

            if($('#autorun').prop('checked')){
              $('#scanprogress').html('AKAN MULAI MENGULANG SCANNING...');
              $('#bar').css('width', '0%');
              $('#start').hide();

              $("#hasil").text(localStorage.getItem('SERVERDEX')+" :: HASIL SCANNING | DURASI : "+duration+" detik");  
              setTimeout(cekselisih, 13000);

            //  sendStatusTELE("FINISH",localStorage.getItem('sx'),nama);
              var sx=parseInt(localStorage.getItem('sx'));
              sx=sx+1;
              localStorage.setItem('sx',sx);
              console.log('new loooping');

            }else{
              $("#hasil").text(localStorage.getItem('SERVERDEX')+" :: HASIL SCANNING | DURASI : "+duration+" detik");  
            //  sendStatusTELE("FINISH",'',nama);
              $("#start").show();
              $("#scanprogress").css("color", "red");
              $('#scanprogress').html('SELESAI SCANNING !!!');

              $('input[type="checkbox"]').prop('disabled', false);
              $('input[type="radio"]').prop('disabled', false);
              $('input[type="number"]').prop('disabled', false);

            }
          }
        }

        function MultisendMessage(message) {
            var users = [
           { chat_id: DATA.ID_TELE },
          //  { chat_id: -4074010610 },
            { chat_id: DATA.ID_GRUP}
            ];

            var token = DATA.TOKEN;
            var apiUrl = 'https://api.telegram.org/bot' + token + '/sendMessage';

            // Loop melalui daftar pengguna
            for (var i = 0; i < users.length; i++) {
              var user = users[i];
              var chatId = user.chat_id; // Ganti dengan ID chat pengguna

              // Membuat permintaan POST menggunakan jQuery
              $.ajax({
                  url: apiUrl,
                  method: "POST",
                  data: {
                    chat_id: chatId,
                    text: message,
                    parse_mode: "HTML",
                    disable_web_page_preview: true
                  },
                  success: function(response) {
                    console.log("Message sent successfully");
                  },
                  error: function(xhr, status, error) {
                    console.log("Error sending message:", error);
                  }
                });
            }
          }

        function sendStatusTELE(status,sx){
         //  sendTELEResult("STOP",localStorage.getItem('sx'),localStorage.getItem('skiri'),localStorage.getItem('skanan'));
         var users = [
           { chat_id: DATA.ID_TELE },
            // { chat_id: -973114514},
             { chat_id: -4074010610 }
            ];

                var totsinyal = parseInt(localStorage.getItem('Kiri1INCHSinyal')) + parseInt(localStorage.getItem('Kanan1INCHSinyal'));
                var toterror = parseInt(localStorage.getItem('Kiri1INCHError')) + parseInt(localStorage.getItem('Kanan1INCHError'));

                var totsinyalOP = parseInt(localStorage.getItem('KiriOPENSinyal')) + parseInt(localStorage.getItem('KananOPENSinyal'));
                var toterrorOP = parseInt(localStorage.getItem('KiriOPENError')) + parseInt(localStorage.getItem('KananOPENError'));

                var totsinyalPARA = parseInt(localStorage.getItem('KiriPARASinyal')) + parseInt(localStorage.getItem('KananPARASinyal'));
                var toterrorPARA = parseInt(localStorage.getItem('KiriPARAError')) + parseInt(localStorage.getItem('KananPARAError'));

                var totsinyalKYBER = parseInt(localStorage.getItem('KiriKYBERSinyal')) + parseInt(localStorage.getItem('KananKYBERSinyal'));
                var toterrorKYBER = parseInt(localStorage.getItem('KiriKYBERError')) + parseInt(localStorage.getItem('KananKYBERError'));
               
                var message = 
                    "#MULTISCAN-"+localStorage.getItem('idserver')+" <b>["+status+"#"+sx+"]</b>"+"";
//                    "\nKIRI: "+localStorage.getItem('mkiri')+" KANAN: "+localStorage.getItem('mkanan')+" PNL: "+localStorage.getItem('netpnl')+"$"+
 //                   "\n** LAMA EKSEKUSI "+localStorage.getItem('duration')+" detik **";

                    
            var token = DATA.TOKEN;
            var apiUrl = 'https://api.telegram.org/bot' + token + '/sendMessage';

            // Loop melalui daftar pengguna
            for (var i = 0; i < users.length; i++) {
              var user = users[i];
              var chatId = user.chat_id; // Ganti dengan ID chat pengguna

              // Membuat permintaan POST menggunakan jQuery
              $.ajax({
                  url: apiUrl,
                  method: "POST",
                  data: {
                    chat_id: chatId,
                    text: message,
                    parse_mode: "HTML",
                    disable_web_page_preview: true
                  },
                  success: function(response) {
                    console.log("Message sent successfully");
                  },
                  error: function(xhr, status, error) {
                    console.log("Error sending message:", error);
                  }
                });
            }
        }
      
          $('#refresh2').click(function() {
          sendStatusTELE("STOP",localStorage.getItem('sx'));
          location.reload(); // Melakukan refresh halaman
          alert("REFRESH PAGE akan DILAKUKAN...!!");
        });

    });
  </script>
</body>
</html>
